Algorithm that estimates unknowns from a series of measurements over time


The Kalman filter keeps track of the estimated state of the system and the variance or uncertainty of the estimate  The estimate is updated using a state transition model and measurements  
  
    
      
        
          
            
              
                x
                  x e 
              
            
          
          
            k
              x     
            k
              x     
             
          
        
      
    
      displaystyle   hat  x    k mid k    
  
 denotes the estimate of the system s state at time step k before the k th measurement yk has been taken into account  
  
    
      
        
          P
          
            k
              x     
            k
              x     
             
          
        
      
    
      displaystyle P  k mid k    
  
 is the corresponding uncertainty 
In statistics and control theory  Kalman filtering  also known as linear quadratic estimation  is an algorithm that uses a series of measurements observed over time  including statistical noise and other inaccuracies  to produce estimates of unknown variables that tend to be more accurate than those based on a single measurement  by estimating a joint probability distribution over the variables for each time step  The filter is constructed as a mean squared error minimiser  but an alternative derivation of the filter is also provided showing how the filter relates to maximum likelihood statistics             The filter is named after Rudolf E  K lm n 
Kalman filtering            has numerous technological applications  A common application is for guidance  navigation  and control of vehicles  particularly aircraft  spacecraft and ships positioned dynamically             Furthermore  Kalman filtering is much applied in time series analysis tasks such as signal processing and econometrics  Kalman filtering is also important for robotic motion planning and control                        and can be used for trajectory optimization             Kalman filtering also works for modeling the central nervous system s control of movement  Due to the time delay between issuing motor commands and receiving sensory feedback  the use of Kalman filters            provides a realistic model for making estimates of the current state of a motor system and issuing updated commands            
The algorithm works via a two phase process  a prediction phase and an update phase  In the prediction phase  the Kalman filter produces estimates of the current state variables  including their uncertainties  Once the outcome of the next measurement  necessarily corrupted with some error  including random noise  is observed  these estimates are updated using a weighted average  with more weight given to estimates with greater certainty  The algorithm is recursive  It can operate in real time  using only the present input measurements and the state calculated previously and its uncertainty matrix  no additional past information is required 
Optimality of Kalman filtering assumes that errors have a normal  Gaussian  distribution  In the words of Rudolf E  K lm n   The following assumptions are made about random processes  Physical random phenomena may be thought of as due to primary random sources exciting dynamic systems  The primary sources are assumed to be independent gaussian random processes with zero mean  the dynamic systems will be linear              Regardless of Gaussianity  however  if the process and measurement covariances are known  then the Kalman filter is the best possible linear estimator in the minimum mean square error sense              although there may be better nonlinear estimators  It is a common misconception  perpetuated in the literature  that the Kalman filter cannot be rigorously applied unless all noise processes are assumed to be Gaussian             
Extensions and generalizations of the method have also been developed  such as the extended Kalman filter and the unscented Kalman filter which work on nonlinear systems  The basis is a hidden Markov model such that the state space of the latent variables is continuous and all latent and observed variables have Gaussian distributions  Kalman filtering has been used successfully in multi sensor fusion              and distributed sensor networks to develop distributed or consensus Kalman filtering             


History edit 
The filtering method is named for Hungarian  migr  Rudolf E  K lm n  although Thorvald Nicolai Thiele                         and Peter Swerling developed a similar algorithm earlier  Richard S  Bucy of the Johns Hopkins Applied Physics Laboratory contributed to the theory  causing it to be known sometimes as Kalman Bucy filtering  Kalman was inspired to derive the Kalman filter by applying state variables to the Wiener filtering problem             
Stanley F  Schmidt is generally credited with developing the first implementation of a Kalman filter  He realized that the filter could be divided into two distinct parts  with one part for time periods between sensor outputs and another part for incorporating measurements              It was during a visit by K lm n to the NASA Ames Research Center that Schmidt saw the applicability of K lm n s ideas to the nonlinear problem of trajectory estimation for the Apollo program resulting in its incorporation in the Apollo navigation computer                                  
This digital filter is sometimes termed the Stratonovich Kalman Bucy filter because it is a special case of a more general  nonlinear filter developed by the Soviet mathematician Ruslan Stratonovich                                                  In fact  some of the special case linear filter s equations appeared in papers by Stratonovich that were published before the summer of       when Kalman met with Stratonovich during a conference in Moscow             
This Kalman filtering was first described and developed partially in technical papers by Swerling         Kalman        and Kalman and Bucy        

The Apollo computer used  k of magnetic core RAM and   k wire rope        The CPU was built from ICs        Clock speed was under     kHz        The fact that the MIT engineers were able to pack such good software  one of the very first applications of the Kalman filter  into such a tiny computer is truly remarkable         Interview with Jack Crenshaw  by Matthew Reed  TRS    org           
Kalman filters have been vital in the implementation of the navigation systems of U S  Navy nuclear ballistic missile submarines  and in the guidance and navigation systems of cruise missiles such as the U S  Navy s Tomahawk missile and the U S  Air Force s Air Launched Cruise Missile  They are also used in the guidance and navigation systems of reusable launch vehicles and the attitude control and navigation systems of spacecraft which dock at the International Space Station             

Overview of the calculation edit 
Kalman filtering uses a system s dynamic model  e g   physical laws of motion   known control inputs to that system  and multiple sequential measurements  such as from sensors  to form an estimate of the system s varying quantities  its state  that is better than the estimate obtained by using only one measurement alone  As such  it is a common sensor fusion and data fusion algorithm 
Noisy sensor data  approximations in the equations that describe the system evolution  and external factors that are not accounted for  all limit how well it is possible to determine the system s state  The Kalman filter deals effectively with the uncertainty due to noisy sensor data and  to some extent  with random external factors  The Kalman filter produces an estimate of the state of the system as an average of the system s predicted state and of the new measurement using a weighted average  The purpose of the weights is that values with better  i e   smaller  estimated uncertainty are  trusted  more  The weights are calculated from the covariance  a measure of the estimated uncertainty of the prediction of the system s state  The result of the weighted average is a new state estimate that lies between the predicted and measured state  and has a better estimated uncertainty than either alone  This process is repeated at every time step  with the new estimate and its covariance informing the prediction used in the following iteration  This means that Kalman filter works recursively and requires only the last  best guess   rather than the entire history  of a system s state to calculate a new state 
The measurements  certainty grading and current state estimate are important considerations  It is common to discuss the filter s response in terms of the Kalman filter s gain  The Kalman gain is the weight given to the measurements and current state estimate  and can be  tuned  to achieve a particular performance  With a high gain  the filter places more weight on the most recent measurements  and thus conforms to them more responsively  With a low gain  the filter conforms to the model predictions more closely  At the extremes  a high gain  close to one  will result in a more jumpy estimated trajectory  while a low gain  close to zero  will smooth out noise but decrease the responsiveness 
When performing the actual calculations for the filter  as discussed below   the state estimate and covariances are coded into matrices because of the multiple dimensions involved in a single set of calculations  This allows for a representation of linear relationships between different state variables  such as position  velocity  and acceleration  in any of the transition models or covariances 

Example application edit 
As an example application  consider the problem of determining the precise location of a truck  The truck can be equipped with a GPS unit that provides an estimate of the position within a few meters  The GPS estimate is likely to be noisy  readings  jump around  rapidly  though remaining within a few meters of the real position  In addition  since the truck is expected to follow the laws of physics  its position can also be estimated by integrating its velocity over time  determined by keeping track of wheel revolutions and the angle of the steering wheel  This is a technique known as dead reckoning  Typically  the dead reckoning will provide a very smooth estimate of the truck s position  but it will drift over time as small errors accumulate 
For this example  the Kalman filter can be thought of as operating in two distinct phases  predict and update  In the prediction phase  the truck s old position will be modified according to the physical laws of motion  the dynamic or  state transition  model   Not only will a new position estimate be calculated  but also a new covariance will be calculated as well  Perhaps the covariance is proportional to the speed of the truck because we are more uncertain about the accuracy of the dead reckoning position estimate at high speeds but very certain about the position estimate at low speeds  Next  in the update phase  a measurement of the truck s position is taken from the GPS unit  Along with this measurement comes some amount of uncertainty  and its covariance relative to that of the prediction from the previous phase determines how much the new measurement will affect the updated prediction  Ideally  as the dead reckoning estimates tend to drift away from the real position  the GPS measurement should pull the position estimate back toward the real position but not disturb it to the point of becoming noisy and rapidly jumping 

Technical description and context edit 
The Kalman filter is an efficient recursive filter estimating the internal state of a linear dynamic system from a series of noisy measurements   It is used in a wide range of engineering and econometric applications from radar and computer vision to estimation of structural macroeconomic models                          and is an important topic in control theory and control systems engineering   Together with the linear quadratic regulator  LQR   the Kalman filter solves the linear quadratic Gaussian control problem  LQG    The Kalman filter  the linear quadratic regulator  and the linear quadratic Gaussian controller are solutions to what arguably are the most fundamental problems of control theory 
In most applications  the internal state is much larger  has more degrees of freedom  than the few  observable  parameters which are measured   However  by combining a series of measurements  the Kalman filter can estimate the entire internal state 
For the Dempster Shafer theory  each state equation or observation is considered a special case of a linear belief function and the Kalman filtering is a special case of combining linear belief functions on a join tree or Markov tree  Additional methods include belief filtering which use Bayes or evidential updates to the state equations 
A wide variety of Kalman filters exists by now  Kalman s original formulation   now termed the  simple  Kalman filter  the Kalman Bucy filter  Schmidt s  extended  filter  the information filter  and a variety of  square root  filters that were developed by Bierman  Thornton  and many others  Perhaps the most commonly used type of very simple Kalman filter is the phase locked loop  which is now ubiquitous in radios  especially frequency modulation  FM  radios  television sets  satellite communications receivers  outer space communications systems  and nearly any other electronic communications equipment 

Underlying dynamic system model edit 
Kalman filtering is based on linear dynamic systems discretized in the time domain  They are modeled on a Markov chain built on linear operators perturbed by errors that may include Gaussian noise  The state of the target system refers to the ground truth  yet hidden  system configuration of interest  which is represented as a vector of real numbers  At each discrete time increment  a linear operator is applied to the state to generate the new state  with some noise mixed in  and optionally some information from the controls on the system if they are known  Then  another linear operator mixed with more noise generates the measurable outputs  i e   observation  from the true   hidden   state  The Kalman filter may be regarded as analogous to the hidden Markov model  with the difference that the hidden state variables have values in a continuous space as opposed to a discrete state space as for the hidden Markov model  There is a strong analogy between the equations of a Kalman Filter and those of the hidden Markov model  A review of this and other models is given in Roweis and Ghahramani                    and Hamilton         Chapter                
In order to use the Kalman filter to estimate the internal state of a process given only a sequence of noisy observations  one must model the process in accordance with the following framework  This means specifying the matrices  for each time step 
  
    
      
        k
      
    
      displaystyle k 
  
  following 


  
    
      
        
          
            F
          
          
            k
          
        
      
    
      displaystyle  mathbf  F    k  
  
  the state transition model 

  
    
      
        
          
            H
          
          
            k
          
        
      
    
      displaystyle  mathbf  H    k  
  
  the observation model 

  
    
      
        
          
            Q
          
          
            k
          
        
      
    
      displaystyle  mathbf  Q    k  
  
  the covariance of the process noise 

  
    
      
        
          
            R
          
          
            k
          
        
      
    
      displaystyle  mathbf  R    k  
  
  the covariance of the observation noise 
and sometimes 
  
    
      
        
          
            B
          
          
            k
          
        
      
    
      displaystyle  mathbf  B    k  
  
  the control input model as described below  if 
  
    
      
        
          
            B
          
          
            k
          
        
      
    
      displaystyle  mathbf  B    k  
  
 is included  then there is also

  
    
      
        
          
            u
          
          
            k
          
        
      
    
      displaystyle  mathbf  u    k  
  
  the control vector  representing the controlling input into control input model 
As seen below  it is common in many applications that the matrices 
  
    
      
        
          F
        
      
    
      displaystyle  mathbf  F   
  
  
  
    
      
        
          H
        
      
    
      displaystyle  mathbf  H   
  
  
  
    
      
        
          Q
        
      
    
      displaystyle  mathbf  Q   
  
  
  
    
      
        
          R
        
      
    
      displaystyle  mathbf  R   
  
  and 
  
    
      
        
          B
        
      
    
      displaystyle  mathbf  B   
  
 are constant across time  in which case their 
  
    
      
        k
      
    
      displaystyle k 
  
 index may be dropped 

Model underlying the Kalman filter  Squares represent matrices  Ellipses represent multivariate normal distributions  with the mean and covariance matrix enclosed   Unenclosed values are vectors   For the simple case  the various matrices are constant with time  and thus the subscripts are not used  but Kalman filtering allows any of them to change each time step 
The Kalman filter model assumes the true state at time 
  
    
      
        k
      
    
      displaystyle k 
  
 is evolved from the state at 
  
    
      
        k
          x     
         
      
    
      displaystyle k   
  
 according to


  
    
      
        
          
            x
          
          
            k
          
        
         
        
          
            F
          
          
            k
          
        
        
          
            x
          
          
            k
              x     
             
          
        
         
        
          
            B
          
          
            k
          
        
        
          
            u
          
          
            k
          
        
         
        
          
            w
          
          
            k
          
        
      
    
      displaystyle  mathbf  x    k   mathbf  F    k  mathbf  x    k     mathbf  B    k  mathbf  u    k   mathbf  w    k  
  

where


  
    
      
        
          
            F
          
          
            k
          
        
      
    
      displaystyle  mathbf  F    k  
  
 is the state transition model which is applied to the previous state xk   

  
    
      
        
          
            B
          
          
            k
          
        
      
    
      displaystyle  mathbf  B    k  
  
 is the control input model which is applied to the control vector 
  
    
      
        
          
            u
          
          
            k
          
        
      
    
      displaystyle  mathbf  u    k  
  
 

  
    
      
        
          
            w
          
          
            k
          
        
      
    
      displaystyle  mathbf  w    k  
  
 is the process noise  which is assumed to be drawn from a zero mean multivariate normal distribution  
  
    
      
        
          
            N
          
        
      
    
      displaystyle   mathcal  N   
  
  with covariance  
  
    
      
        
          
            Q
          
          
            k
          
        
      
    
      displaystyle  mathbf  Q    k  
  
  
  
    
      
        
          
            w
          
          
            k
          
        
          x   c 
        
          
            N
          
        
        
           
          
             
             
            
              
                Q
              
              
                k
              
            
          
           
        
      
    
      displaystyle  mathbf  w    k  sim   mathcal  N   left    mathbf  Q    k  right  
  
 
If 
  
    
      
        
          Q
        
      
    
      displaystyle  mathbf  Q   
  
 is independent of time  one may  following Roweis and Ghahramani                                    write 
  
    
      
        
          
            w
          
          
              x     
          
        
      
    
      displaystyle  mathbf  w     bullet   
  
 instead of 
  
    
      
        
          
            w
          
          
            k
          
        
      
    
      displaystyle  mathbf  w    k  
  
 to emphasize that the noise has no explicit knowledge of time 
At time 
  
    
      
        k
      
    
      displaystyle k 
  
 an observation  or measurement  
  
    
      
        
          
            z
          
          
            k
          
        
      
    
      displaystyle  mathbf  z    k  
  
of the true state 
  
    
      
        
          
            x
          
          
            k
          
        
      
    
      displaystyle  mathbf  x    k  
  
 is made according to


  
    
      
        
          
            z
          
          
            k
          
        
         
        
          
            H
          
          
            k
          
        
        
          
            x
          
          
            k
          
        
         
        
          
            v
          
          
            k
          
        
      
    
      displaystyle  mathbf  z    k   mathbf  H    k  mathbf  x    k   mathbf  v    k  
  

where


  
    
      
        
          
            H
          
          
            k
          
        
      
    
      displaystyle  mathbf  H    k  
  
 is the observation model  which maps the true state space into the observed space and

  
    
      
        
          
            v
          
          
            k
          
        
      
    
      displaystyle  mathbf  v    k  
  
 is the observation noise  which is assumed to be zero mean Gaussian white noise with covariance 
  
    
      
        
          
            R
          
          
            k
          
        
      
    
      displaystyle  mathbf  R    k  
  
  
  
    
      
        
          
            v
          
          
            k
          
        
          x   c 
        
          
            N
          
        
        
           
          
             
             
            
              
                R
              
              
                k
              
            
          
           
        
      
    
      displaystyle  mathbf  v    k  sim   mathcal  N   left    mathbf  R    k  right  
  
 
Analogously to the situation for 
  
    
      
        
          
            w
          
          
            k
          
        
      
    
      displaystyle  mathbf  w    k  
  
  one may write 
  
    
      
        
          
            v
          
          
              x     
          
        
      
    
      displaystyle  mathbf  v     bullet   
  
 instead of 
  
    
      
        
          
            v
          
          
            k
          
        
      
    
      displaystyle  mathbf  v    k  
  
  if 
  
    
      
        
          R
        
      
    
      displaystyle  mathbf  R   
  
 is independent of time 
The initial state  and the noise vectors at each step 
  
    
      
         
        
          
            x
          
          
             
          
        
         
        
          
            w
          
          
             
          
        
         
          x     
         
        
          
            w
          
          
            k
          
        
         
        
          
            v
          
          
             
          
        
         
          x     
         
        
          
            v
          
          
            k
          
        
         
      
    
      displaystyle    mathbf  x        mathbf  w        dots   mathbf  w    k   mathbf  v        dots   mathbf  v    k    
  
 are all assumed to be mutually independent 
Many real time dynamic systems do not exactly conform to this model  In fact  unmodeled dynamics can seriously degrade the filter performance  even when it was supposed to work with unknown stochastic signals as inputs  The reason for this is that the effect of unmodeled dynamics depends on the input  and  therefore  can bring the estimation algorithm to instability  it diverges   On the other hand  independent white noise signals will not make the algorithm diverge  The problem of distinguishing between measurement noise and unmodeled dynamics is a difficult one and is treated as a problem of control theory using robust control                         

Details edit 
The Kalman filter is a recursive estimator  This means that only the estimated state from the previous time step and the current measurement are needed to compute the estimate for the current state  In contrast to batch estimation techniques  no history of observations and or estimates is required  In what follows  the notation 
  
    
      
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            n
              x     
            m
          
        
      
    
      displaystyle   hat   mathbf  x      n mid m  
  
 represents the estimate of 
  
    
      
        
          x
        
      
    
      displaystyle  mathbf  x   
  
 at time n given observations up to and including at time m   n 
The state of the filter is represented by two variables 


  
    
      
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            k
              x     
            k
          
        
      
    
      displaystyle   hat   mathbf  x      k mid k  
  
  the a posteriori state estimate mean at time k given observations up to and including at time k 

  
    
      
        
          
            P
          
          
            k
              x     
            k
          
        
      
    
      displaystyle  mathbf  P    k mid k  
  
  the a posteriori estimate covariance matrix  a measure of the estimated accuracy of the state estimate  
The algorithm structure of the Kalman filter resembles that of Alpha beta filter  The Kalman filter can be written as a single equation  however  it is most often conceptualized as two distinct phases   Predict  and  Update   The predict phase uses the state estimate from the previous timestep to produce an estimate of the state at the current timestep  This predicted state estimate is also known as the a priori state estimate because  although it is an estimate of the state at the current timestep  it does not include observation information from the current timestep  In the update phase  the innovation  the pre fit residual   i e  the difference between the current a priori prediction and the current observation information  is multiplied by the optimal Kalman gain and combined with the previous state estimate to refine the state estimate  This improved estimate based on the current observation is termed the a posteriori state estimate 
Typically  the two phases alternate  with the prediction advancing the state until the next scheduled observation  and the update incorporating the observation   However  this is not necessary  if an observation is unavailable for some reason  the update may be skipped and multiple prediction procedures performed   Likewise  if multiple independent observations are available at the same time  multiple update procedures may be performed  typically with different observation matrices Hk                          

Predict edit 



Predicted  a priori  state estimate


  
    
      
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            k
              x     
            k
              x     
             
          
        
         
        
          
            F
          
          
            k
          
        
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            k
              x     
             
              x     
            k
              x     
             
          
        
         
        
          
            B
          
          
            k
          
        
        
          
            u
          
          
            k
          
        
      
    
      displaystyle   hat   mathbf  x      k mid k     mathbf  F    k   hat   mathbf  x      k   mid k     mathbf  B    k  mathbf  u    k  
  



Predicted  a priori  estimate covariance


  
    
      
        
          
            
              P
            
          
          
            k
              x     
            k
              x     
             
          
        
         
        
          
            F
          
          
            k
          
        
        
          
            P
          
          
            k
              x     
             
              x     
            k
              x     
             
          
        
        
          
            F
          
          
            k
          
          
            
              T
            
          
        
         
        
          
            Q
          
          
            k
          
        
      
    
      displaystyle   mathbf  P     k mid k     mathbf  F    k  mathbf  P    k   mid k    mathbf  F    k    textsf  T    mathbf  Q    k  
  


Update edit 



Innovation or measurement pre fit residual


  
    
      
        
          
            
              
                
                  y
                
                  x e 
              
            
          
          
            k
          
        
         
        
          
            z
          
          
            k
          
        
          x     
        
          
            H
          
          
            k
          
        
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            k
              x     
            k
              x     
             
          
        
      
    
      displaystyle   tilde   mathbf  y      k   mathbf  z    k   mathbf  H    k   hat   mathbf  x      k mid k    
  



Innovation  or pre fit residual  covariance


  
    
      
        
          
            S
          
          
            k
          
        
         
        
          
            H
          
          
            k
          
        
        
          
            
              P
            
          
          
            k
              x     
            k
              x     
             
          
        
        
          
            H
          
          
            k
          
          
            
              T
            
          
        
         
        
          
            R
          
          
            k
          
        
      
    
      displaystyle  mathbf  S    k   mathbf  H    k   mathbf  P     k mid k    mathbf  H    k    textsf  T    mathbf  R    k  
  



Optimal Kalman gain


  
    
      
        
          
            K
          
          
            k
          
        
         
        
          
            
              P
            
          
          
            k
              x     
            k
              x     
             
          
        
        
          
            H
          
          
            k
          
          
            
              T
            
          
        
        
          
            S
          
          
            k
          
          
              x     
             
          
        
      
    
      displaystyle  mathbf  K    k    mathbf  P     k mid k    mathbf  H    k    textsf  T   mathbf  S    k       
  



Updated  a posteriori  state estimate


  
    
      
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            k
              x     
            k
          
        
         
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            k
              x     
            k
              x     
             
          
        
         
        
          
            K
          
          
            k
          
        
        
          
            
              
                
                  y
                
                  x e 
              
            
          
          
            k
          
        
      
    
      displaystyle   hat   mathbf  x      k mid k    hat   mathbf  x      k mid k     mathbf  K    k   tilde   mathbf  y      k  
  



Updated  a posteriori  estimate covariance


  
    
      
        
          
            P
          
          
            k
            
               
            
            k
          
        
         
        
           
          
            
              I
            
              x     
            
              
                K
              
              
                k
              
            
            
              
                H
              
              
                k
              
            
          
           
        
        
          
            
              P
            
          
          
            k
            
               
            
            k
              x     
             
          
        
      
    
      displaystyle  mathbf  P    k k   left  mathbf  I    mathbf  K    k  mathbf  H    k  right   mathbf  P     k k    
  



Measurement post fit residual


  
    
      
        
          
            
              
                
                  y
                
                  x e 
              
            
          
          
            k
              x     
            k
          
        
         
        
          
            z
          
          
            k
          
        
          x     
        
          
            H
          
          
            k
          
        
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            k
              x     
            k
          
        
      
    
      displaystyle   tilde   mathbf  y      k mid k   mathbf  z    k   mathbf  H    k   hat   mathbf  x      k mid k  
  


The formula for the updated  a posteriori  estimate covariance above is valid for the optimal Kk gain that minimizes the residual error  in which form it is most widely used in applications  Proof of the formulae is found in the derivations section  where the formula valid for any Kk is also shown 
A more intuitive way to express the updated state estimate  
  
    
      
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            k
              x     
            k
          
        
      
    
      displaystyle   hat   mathbf  x      k mid k  
  
  is 


  
    
      
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            k
              x     
            k
          
        
         
         
        
          I
        
          x     
        
          
            K
          
          
            k
          
        
        
          
            H
          
          
            k
          
        
         
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            k
              x     
            k
              x     
             
          
        
         
        
          
            K
          
          
            k
          
        
        
          
            z
          
          
            k
          
        
      
    
      displaystyle   hat   mathbf  x      k mid k    mathbf  I    mathbf  K    k  mathbf  H    k    hat   mathbf  x      k mid k     mathbf  K    k  mathbf  z    k  
  

This expression reminds us of a linear interpolation  
  
    
      
        x
         
         
         
          x     
        t
         
         
        a
         
         
        t
         
        b
         
      
    
      displaystyle x    t  a  t b  
  
 for 
  
    
      
        t
      
    
      displaystyle t 
  
 between        
In our case 


  
    
      
        t
      
    
      displaystyle t 
  
 is the matrix 
  
    
      
        
          
            K
          
          
            k
          
        
        
          
            H
          
          
            k
          
        
      
    
      displaystyle  mathbf  K    k  mathbf  H    k  
  
 that takes values from 
  
    
      
         
      
    
      displaystyle   
  
  high error in the sensor  to 
  
    
      
        I
      
    
      displaystyle I 
  
 or a projection  low error  

  
    
      
        a
      
    
      displaystyle a 
  
 is the internal state 
  
    
      
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            k
              x     
            k
              x     
             
          
        
      
    
      displaystyle   hat   mathbf  x      k mid k    
  
 estimated from the model 

  
    
      
        b
      
    
      displaystyle b 
  
 is the internal state 
  
    
      
        
          
            K
          
          
            k
          
        
        
          
            z
          
          
            k
          
        
      
    
      displaystyle  mathbf  K    k  mathbf  z    k  
  
 estimated from the measurement  assuming 
  
    
      
        
          
            K
          
          
            k
          
        
      
    
      displaystyle  mathbf  K    k  
  
 is nonsingular 
This expression also resembles the alpha beta filter update step 

Invariants edit 
If the model is accurate  and the values for 
  
    
      
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
             
              x     
             
          
        
      
    
      displaystyle   hat   mathbf  x        mid    
  
 and 
  
    
      
        
          
            P
          
          
             
              x     
             
          
        
      
    
      displaystyle  mathbf  P      mid    
  
 accurately reflect the distribution of the initial state values  then the following invariants are preserved 


  
    
      
        
          
            
              
                E
                  x     
                 
                
                  
                    x
                  
                  
                    k
                  
                
                  x     
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                    k
                  
                
                 
              
              
                
                 
                E
                  x     
                 
                
                  
                    x
                  
                  
                    k
                  
                
                  x     
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
                 
                 
                 
              
            
            
              
                E
                  x     
                 
                
                  
                    
                      
                        
                          y
                        
                          x e 
                      
                    
                  
                  
                    k
                  
                
                 
              
              
                
                 
                 
              
            
          
        
      
    
      displaystyle   begin aligned  operatorname  E    mathbf  x    k    hat   mathbf  x      k mid k   amp   operatorname  E    mathbf  x    k    hat   mathbf  x      k mid k         operatorname  E     tilde   mathbf  y      k   amp    end aligned   
  

where 
  
    
      
        E
          x     
         
          x be 
         
      
    
      displaystyle  operatorname  E    xi   
  
 is the expected value of 
  
    
      
          x be 
      
    
      displaystyle  xi  
  
  That is  all estimates have a mean error of zero 
Also 


  
    
      
        
          
            
              
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                  
                
              
              
                
                 
                cov
                  x     
                
                   
                  
                    
                      
                        x
                      
                      
                        k
                      
                    
                      x     
                    
                      
                        
                          
                            
                              x
                            
                              x e 
                          
                        
                      
                      
                        k
                          x     
                        k
                      
                    
                  
                   
                
              
            
            
              
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
              
              
                
                 
                cov
                  x     
                
                   
                  
                    
                      
                        x
                      
                      
                        k
                      
                    
                      x     
                    
                      
                        
                          
                            
                              x
                            
                              x e 
                          
                        
                      
                      
                        k
                          x     
                        k
                          x     
                         
                      
                    
                  
                   
                
              
            
            
              
                
                  
                    S
                  
                  
                    k
                  
                
              
              
                
                 
                cov
                  x     
                
                   
                  
                    
                      
                        
                          
                            y
                          
                            x e 
                        
                      
                    
                    
                      k
                    
                  
                   
                
              
            
          
        
      
    
      displaystyle   begin aligned  mathbf  P    k mid k  amp   operatorname  cov   left  mathbf  x    k    hat   mathbf  x      k mid k  right    mathbf  P    k mid k    amp   operatorname  cov   left  mathbf  x    k    hat   mathbf  x      k mid k    right    mathbf  S    k  amp   operatorname  cov   left   tilde   mathbf  y      k  right  end aligned   
  

so covariance matrices accurately reflect the covariance of estimates 

Estimation of the noise covariances Qk and Rk edit 
Practical implementation of a Kalman Filter is often difficult due to the difficulty of getting a good estimate of the noise covariance matrices Qk and Rk   Extensive research has been done to estimate these covariances from data   One practical method of doing this is the autocovariance least squares  ALS  technique that uses the time lagged autocovariances of routine operating data to estimate the covariances                           The GNU Octave and Matlab code used to calculate the noise covariance matrices using the ALS technique is available online using the GNU General Public License              Field Kalman Filter  FKF   a Bayesian algorithm  which allows simultaneous estimation of the state  parameters and noise covariance has been proposed              The FKF algorithm has a recursive formulation  good observed convergence  and relatively low complexity  thus suggesting that the FKF algorithm may possibly be a worthwhile alternative to the Autocovariance Least Squares methods  Another approach is the Optimized Kalman Filter  OKF   which considers the covariance matrices not as representatives of the noise  but rather  as parameters aimed to achieve the most accurate state estimation              These two views coincide under the KF assumptions  but often contradict each other in real systems  Thus  OKF s state estimation is more robust to modeling inaccuracies 

Optimality and performance edit 
The Kalman filter provides an optimal state estimation in cases where a  the model matches the real system perfectly  b  the entering noise is  white   uncorrelated   and c  the covariances of the noise are known exactly  Correlated noise can also be treated using Kalman filters              
Several methods for the noise covariance estimation have been proposed during past decades  including ALS  mentioned in the section above  More generally  if the model assumptions do not match the real system perfectly  then optimal state estimation is not necessarily obtained by setting Qk and Rk to the covariances of the noise  Instead  in that case  the parameters Qk and Rk may be set to explicitly optimize the state estimation              e g   using standard supervised learning 
After the covariances are set  it is useful to evaluate the performance of the filter  i e   whether it is possible to improve the state estimation quality  If the Kalman filter works optimally  the innovation sequence  the output prediction error  is a white noise  therefore the whiteness property of the innovations measures filter performance  Several different methods can be used for this purpose              If the noise terms are distributed in a non Gaussian manner  methods for assessing performance of the filter estimate  which use probability inequalities or large sample theory  are known in the literature                         

Example application  technical edit 
             Truth             Filtered process             Observations 
Consider a truck on frictionless  straight rails  Initially  the truck is stationary at position    but it is buffeted this way and that by random uncontrolled forces  We measure the position of the truck every  t seconds  but these measurements are imprecise  we want to maintain a model of the truck s position and velocity  We show here how we derive the model from which we create our Kalman filter 
Since 
  
    
      
        
          F
        
         
        
          H
        
         
        
          R
        
         
        
          Q
        
      
    
      displaystyle  mathbf  F    mathbf  H    mathbf  R    mathbf  Q   
  
 are constant  their time indices are dropped 
The position and velocity of the truck are described by the linear state space


  
    
      
        
          
            x
          
          
            k
          
        
         
        
          
             
            
              
                
                  x
                
              
              
                
                  
                    
                      
                        x
                          x d  
                      
                    
                  
                
              
            
             
          
        
      
    
      displaystyle  mathbf  x    k    begin bmatrix x    dot  x   end bmatrix   
  

where 
  
    
      
        
          
            
              x
                x d  
            
          
        
      
    
      displaystyle   dot  x   
  
 is the velocity  that is  the derivative of position with respect to time 
We assume that between the  k                and k timestep  uncontrolled forces cause a constant acceleration of ak that is normally distributed with mean   and standard deviation  a  From Newton s laws of motion we conclude that


  
    
      
        
          
            x
          
          
            k
          
        
         
        
          F
        
        
          
            x
          
          
            k
              x     
             
          
        
         
        
          G
        
        
          a
          
            k
          
        
      
    
      displaystyle  mathbf  x    k   mathbf  F   mathbf  x    k     mathbf  G  a  k  
  

 there is no 
  
    
      
        
          B
        
        u
      
    
      displaystyle  mathbf  B  u 
  
 term since there are no known control inputs  Instead  ak is the effect of an unknown input and 
  
    
      
        
          G
        
      
    
      displaystyle  mathbf  G   
  
 applies that effect to the state vector  where


  
    
      
        
          
            
              
                
                  F
                
              
              
                
                 
                
                  
                     
                    
                      
                        
                           
                        
                        
                            x    
                          t
                        
                      
                      
                        
                           
                        
                        
                           
                        
                      
                    
                     
                  
                
              
            
            
              
                
                  G
                
              
              
                
                 
                
                  
                     
                    
                      
                        
                          
                            
                               
                               
                            
                          
                          
                            
                                x    
                              t
                            
                            
                               
                            
                          
                        
                      
                      
                        
                            x    
                          t
                        
                      
                    
                     
                  
                
              
            
          
        
      
    
      displaystyle   begin aligned  mathbf  F   amp    begin bmatrix   amp  Delta t    amp   end bmatrix      pt  mathbf  G   amp    begin bmatrix   frac          Delta t         pt  Delta t end bmatrix   end aligned   
  

so that


  
    
      
        
          
            x
          
          
            k
          
        
         
        
          F
        
        
          
            x
          
          
            k
              x     
             
          
        
         
        
          
            w
          
          
            k
          
        
      
    
      displaystyle  mathbf  x    k   mathbf  F   mathbf  x    k     mathbf  w    k  
  

where


  
    
      
        
          
            
              
                
                  
                    w
                  
                  
                    k
                  
                
              
              
                
                  x   c 
                N
                 
                 
                 
                
                  Q
                
                 
              
            
            
              
                
                  Q
                
              
              
                
                 
                
                  G
                
                
                  
                    G
                  
                  
                    
                      T
                    
                  
                
                
                    x c  
                  
                    a
                  
                  
                     
                  
                
                 
                
                  
                     
                    
                      
                        
                          
                            
                               
                               
                            
                          
                          
                            
                                x    
                              t
                            
                            
                               
                            
                          
                        
                        
                          
                            
                               
                               
                            
                          
                          
                            
                                x    
                              t
                            
                            
                               
                            
                          
                        
                      
                      
                        
                          
                            
                               
                               
                            
                          
                          
                            
                                x    
                              t
                            
                            
                               
                            
                          
                        
                        
                          
                            
                                x    
                              t
                            
                            
                               
                            
                          
                        
                      
                    
                     
                  
                
                
                    x c  
                  
                    a
                  
                  
                     
                  
                
                 
              
            
          
        
      
    
      displaystyle   begin aligned  mathbf  w    k  amp  sim N    mathbf  Q      mathbf  Q   amp   mathbf  G   mathbf  G     textsf  T   sigma   a        begin bmatrix   frac          Delta t      amp   frac          Delta t         pt   frac          Delta t      amp   Delta t      end bmatrix   sigma   a       end aligned   
  

The matrix 
  
    
      
        
          Q
        
      
    
      displaystyle  mathbf  Q   
  
 is not full rank  it is of rank one if 
  
    
      
          x    
        t
          x     
         
      
    
      displaystyle  Delta t neq   
  
   Hence  the distribution 
  
    
      
        N
         
         
         
        
          Q
        
         
      
    
      displaystyle N    mathbf  Q    
  
 is not absolutely continuous and has no probability density function  Another way to express this  avoiding explicit degenerate distributions is given by


  
    
      
        
          
            w
          
          
            k
          
        
          x   c 
        
          G
        
          x  c  
        N
        
           
          
             
             
            
                x c  
              
                a
              
              
                 
              
            
          
           
        
         
      
    
      displaystyle  mathbf  w    k  sim  mathbf  G   cdot N left    sigma   a      right   
  

At each time phase  a noisy measurement of the true position of the truck is made  Let us suppose the measurement noise vk is also distributed normally  with mean   and standard deviation  z 


  
    
      
        
          
            z
          
          
            k
          
        
         
        
          
            H
            x
          
          
            k
          
        
         
        
          
            v
          
          
            k
          
        
      
    
      displaystyle  mathbf  z    k   mathbf  Hx    k   mathbf  v    k  
  

where


  
    
      
        
          H
        
         
        
          
             
            
              
                
                   
                
                
                   
                
              
            
             
          
        
      
    
      displaystyle  mathbf  H     begin bmatrix   amp   end bmatrix   
  

and


  
    
      
        
          R
        
         
        
          E
        
        
           
          
            
              
                v
              
              
                k
              
            
            
              
                v
              
              
                k
              
              
                
                  T
                
              
            
          
           
        
         
        
          
             
            
              
                
                  
                      x c  
                    
                      z
                    
                    
                       
                    
                  
                
              
            
             
          
        
      
    
      displaystyle  mathbf  R    mathrm  E   left  mathbf  v    k  mathbf  v    k    textsf  T   right    begin bmatrix  sigma   z      end bmatrix   
  

We know the initial starting state of the truck with perfect precision  so we initialize


  
    
      
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
             
              x     
             
          
        
         
        
          
             
            
              
                
                   
                
              
              
                
                   
                
              
            
             
          
        
      
    
      displaystyle   hat   mathbf  x        mid      begin bmatrix      end bmatrix   
  

and to tell the filter that we know the exact position and velocity  we give it a zero covariance matrix 


  
    
      
        
          
            P
          
          
             
              x     
             
          
        
         
        
          
             
            
              
                
                   
                
                
                   
                
              
              
                
                   
                
                
                   
                
              
            
             
          
        
      
    
      displaystyle  mathbf  P      mid      begin bmatrix   amp      amp   end bmatrix   
  

If the initial position and velocity are not known perfectly  the covariance matrix should be initialized with suitable variances on its diagonal 


  
    
      
        
          
            P
          
          
             
              x     
             
          
        
         
        
          
             
            
              
                
                  
                      x c  
                    
                      x
                    
                    
                       
                    
                  
                
                
                   
                
              
              
                
                   
                
                
                  
                      x c  
                    
                      
                        
                          x
                            x d  
                        
                      
                    
                    
                       
                    
                  
                
              
            
             
          
        
      
    
      displaystyle  mathbf  P      mid      begin bmatrix  sigma   x      amp      amp  sigma    dot  x       end bmatrix   
  

The filter will then prefer the information from the first measurements over the information already in the model 

Asymptotic form edit 
For simplicity  assume that the control input 
  
    
      
        
          
            u
          
          
            k
          
        
         
        
           
        
      
    
      displaystyle  mathbf  u    k   mathbf      
  
  Then the Kalman filter may be written 


  
    
      
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            k
              x     
            k
          
        
         
        
          
            F
          
          
            k
          
        
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            k
              x     
             
              x     
            k
              x     
             
          
        
         
        
          
            K
          
          
            k
          
        
         
        
          
            z
          
          
            k
          
        
          x     
        
          
            H
          
          
            k
          
        
        
          
            F
          
          
            k
          
        
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            k
              x     
             
              x     
            k
              x     
             
          
        
         
         
      
    
      displaystyle   hat   mathbf  x      k mid k   mathbf  F    k   hat   mathbf  x      k   mid k     mathbf  K    k   mathbf  z    k   mathbf  H    k  mathbf  F    k   hat   mathbf  x      k   mid k      
  

A similar equation holds if we include a non zero control input  Gain matrices 
  
    
      
        
          
            K
          
          
            k
          
        
      
    
      displaystyle  mathbf  K    k  
  
 evolve independently of the measurements 
  
    
      
        
          
            z
          
          
            k
          
        
      
    
      displaystyle  mathbf  z    k  
  
  From above  the four equations needed for updating the Kalman gain are as follows 


  
    
      
        
          
            
              
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
              
              
                
                 
                
                  
                    F
                  
                  
                    k
                  
                
                
                  
                    P
                  
                  
                    k
                      x     
                     
                      x     
                    k
                      x     
                     
                  
                
                
                  
                    F
                  
                  
                    k
                  
                  
                    
                      T
                    
                  
                
                 
                
                  
                    Q
                  
                  
                    k
                  
                
                 
              
            
            
              
                
                  
                    S
                  
                  
                    k
                  
                
              
              
                
                 
                
                  
                    H
                  
                  
                    k
                  
                
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
                
                  
                    H
                  
                  
                    k
                  
                  
                    
                      T
                    
                  
                
                 
                
                  
                    R
                  
                  
                    k
                  
                
                 
              
            
            
              
                
                  
                    K
                  
                  
                    k
                  
                
              
              
                
                 
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
                
                  
                    H
                  
                  
                    k
                  
                  
                    
                      T
                    
                  
                
                
                  
                    S
                  
                  
                    k
                  
                  
                      x     
                     
                  
                
                 
              
            
            
              
                
                  
                    P
                  
                  
                    k
                    
                       
                    
                    k
                  
                
              
              
                
                 
                
                   
                  
                    
                      I
                    
                      x     
                    
                      
                        K
                      
                      
                        k
                      
                    
                    
                      
                        H
                      
                      
                        k
                      
                    
                  
                   
                
                
                  
                    P
                  
                  
                    k
                    
                       
                    
                    k
                      x     
                     
                  
                
                 
              
            
          
        
      
    
      displaystyle   begin aligned  mathbf  P    k mid k    amp   mathbf  F    k  mathbf  P    k   mid k    mathbf  F    k    textsf  T    mathbf  Q    k     mathbf  S    k  amp   mathbf  H    k  mathbf  P    k mid k    mathbf  H    k    textsf  T    mathbf  R    k     mathbf  K    k  amp   mathbf  P    k mid k    mathbf  H    k    textsf  T   mathbf  S    k          mathbf  P    k k  amp   left  mathbf  I    mathbf  K    k  mathbf  H    k  right  mathbf  P    k k     end aligned   
  

Since the gain matrices depend only on the model  and not the measurements  they may be computed offline  Convergence of the gain matrices 
  
    
      
        
          
            K
          
          
            k
          
        
      
    
      displaystyle  mathbf  K    k  
  
 to an asymptotic matrix 
  
    
      
        
          
            K
          
          
              x   e 
          
        
      
    
      displaystyle  mathbf  K     infty   
  
 applies for conditions established in Walrand and Dimakis              Simulations establish the number of steps to convergence  For the moving truck example described above  with 
  
    
      
          x    
        t
         
         
      
    
      displaystyle  Delta t   
  
  and 
  
    
      
        
            x c  
          
            a
          
          
             
          
        
         
        
            x c  
          
            z
          
          
             
          
        
         
        
            x c  
          
            x
          
          
             
          
        
         
        
            x c  
          
            
              
                x
                  x d  
              
            
          
          
             
          
        
         
         
      
    
      displaystyle  sigma   a       sigma   z       sigma   x       sigma    dot  x         
  
  simulation shows convergence in 
  
    
      
          
      
    
      displaystyle    
  
 iterations 
Using the asymptotic gain  and assuming 
  
    
      
        
          
            H
          
          
            k
          
        
      
    
      displaystyle  mathbf  H    k  
  
 and 
  
    
      
        
          
            F
          
          
            k
          
        
      
    
      displaystyle  mathbf  F    k  
  
 are independent of 
  
    
      
        k
      
    
      displaystyle k 
  
  the Kalman filter becomes a linear time invariant filter 


  
    
      
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            k
          
        
         
        
          F
        
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            k
              x     
             
          
        
         
        
          
            K
          
          
              x   e 
          
        
         
        
          
            z
          
          
            k
          
        
          x     
        
          H
        
        
          F
        
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            k
              x     
             
          
        
         
         
      
    
      displaystyle   hat   mathbf  x      k   mathbf  F    hat   mathbf  x      k     mathbf  K     infty    mathbf  z    k   mathbf  H   mathbf  F    hat   mathbf  x      k      
  

The asymptotic gain 
  
    
      
        
          
            K
          
          
              x   e 
          
        
      
    
      displaystyle  mathbf  K     infty   
  
  if it exists  can be computed by first solving the following discrete Riccati equation for the asymptotic state covariance 
  
    
      
        
          
            P
          
          
              x   e 
          
        
      
    
      displaystyle  mathbf  P     infty   
  
             


  
    
      
        
          
            P
          
          
              x   e 
          
        
         
        
          F
        
        
           
          
            
              
                P
              
              
                  x   e 
              
            
              x     
            
              
                P
              
              
                  x   e 
              
            
            
              
                H
              
              
                
                  T
                
              
            
            
              
                 
                
                  
                    H
                  
                  
                    
                      P
                    
                    
                        x   e 
                    
                  
                  
                    
                      H
                    
                    
                      
                        T
                      
                    
                  
                   
                  
                    R
                  
                
                 
              
              
                  x     
                 
              
            
            
              H
            
            
              
                P
              
              
                  x   e 
              
            
          
           
        
        
          
            F
          
          
            
              T
            
          
        
         
        
          Q
        
         
      
    
      displaystyle  mathbf  P     infty    mathbf  F   left  mathbf  P     infty    mathbf  P     infty   mathbf  H     textsf  T   left  mathbf  H   mathbf  P     infty   mathbf  H     textsf  T    mathbf  R   right       mathbf  H   mathbf  P     infty   right  mathbf  F     textsf  T    mathbf  Q    
  

The asymptotic gain is then computed as before 


  
    
      
        
          
            K
          
          
              x   e 
          
        
         
        
          
            P
          
          
              x   e 
          
        
        
          
            H
          
          
            
              T
            
          
        
        
          
             
            
              
                R
              
               
              
                H
              
              
                
                  P
                
                
                    x   e 
                
              
              
                
                  H
                
                
                  
                    T
                  
                
              
            
             
          
          
              x     
             
          
        
         
      
    
      displaystyle  mathbf  K     infty    mathbf  P     infty   mathbf  H     textsf  T   left  mathbf  R    mathbf  H   mathbf  P     infty   mathbf  H     textsf  T   right        
  

Additionally  a form of the asymptotic Kalman filter more commonly used in control theory is given by


  
    
      
        
          
            
              
                
                  
                    
                      x
                    
                      x e 
                  
                
              
              
                k
                 
                 
              
            
             
            
              F
            
            
              
                
                  
                    
                      x
                    
                      x e 
                  
                
              
              
                k
              
            
             
            
              B
            
            
              
                u
              
              
                k
              
            
             
            
              
                
                  K
                    xaf 
                
              
              
                  x   e 
              
            
             
            
              
                z
              
              
                k
              
            
              x     
            
              H
            
            
              
                
                  
                    
                      x
                    
                      x e 
                  
                
              
              
                k
              
            
             
             
          
        
      
    
      displaystyle   displaystyle   hat   mathbf  x      k     mathbf  F    hat   mathbf  x      k   mathbf  B   mathbf  u    k   mathbf   overline  K      infty    mathbf  z    k   mathbf  H    hat   mathbf  x      k     
  

where


  
    
      
        
          
            
              
                K
              
                xaf 
            
          
          
              x   e 
          
        
         
        
          F
        
        
          
            P
          
          
              x   e 
          
        
        
          
            H
          
          
            
              T
            
          
        
        
          
             
            
              
                R
              
               
              
                H
              
              
                
                  P
                
                
                    x   e 
                
              
              
                
                  H
                
                
                  
                    T
                  
                
              
            
             
          
          
              x     
             
          
        
         
      
    
      displaystyle   overline   mathbf  K       infty    mathbf  F   mathbf  P     infty   mathbf  H     textsf  T   left  mathbf  R    mathbf  H   mathbf  P     infty   mathbf  H     textsf  T   right        
  

This leads to an estimator of the form


  
    
      
        
          
            
              
                
                  
                    
                      x
                    
                      x e 
                  
                
              
              
                k
                 
                 
              
            
             
             
            
              F
            
              x     
            
              
                
                  
                    K
                  
                    xaf 
                
              
              
                  x   e 
              
            
            
              H
            
             
            
              
                
                  
                    
                      x
                    
                      x e 
                  
                
              
              
                k
              
            
             
            
              B
            
            
              
                u
              
              
                k
              
            
             
            
              
                
                  K
                    xaf 
                
              
              
                  x   e 
              
            
            
              
                z
              
              
                k
              
            
             
          
        
      
    
      displaystyle   displaystyle   hat   mathbf  x      k      mathbf  F     overline   mathbf  K       infty   mathbf  H     hat   mathbf  x      k   mathbf  B   mathbf  u    k   mathbf   overline  K      infty   mathbf  z    k    
  

Derivations edit 
This section needs additional citations for verification  Please help improve this article by adding citations to reliable sources     in this section  Unsourced material may be challenged and removed    December        Learn how and when to remove this message 
The Kalman filter can be derived as a generalized least squares method operating on previous data             

Deriving the posteriori estimate covariance matrix edit 
Starting with our invariant on the error covariance Pk             k as above


  
    
      
        
          
            P
          
          
            k
              x     
            k
          
        
         
        cov
          x     
        
           
          
            
              
                x
              
              
                k
              
            
              x     
            
              
                
                  
                    
                      x
                    
                      x e 
                  
                
              
              
                k
                  x     
                k
              
            
          
           
        
      
    
      displaystyle  mathbf  P    k mid k   operatorname  cov   left  mathbf  x    k    hat   mathbf  x      k mid k  right  
  

substitute in the definition of 
  
    
      
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            k
              x     
            k
          
        
      
    
      displaystyle   hat   mathbf  x      k mid k  
  



  
    
      
        
          
            P
          
          
            k
              x     
            k
          
        
         
        cov
          x     
        
           
          
            
              
                x
              
              
                k
              
            
              x     
            
               
              
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
                 
                
                  
                    K
                  
                  
                    k
                  
                
                
                  
                    
                      
                        
                          y
                        
                          x e 
                      
                    
                  
                  
                    k
                  
                
              
               
            
          
           
        
      
    
      displaystyle  mathbf  P    k mid k   operatorname  cov   left  mathbf  x    k   left   hat   mathbf  x      k mid k     mathbf  K    k   tilde   mathbf  y      k  right  right  
  

and substitute  
  
    
      
        
          
            
              
                
                  y
                
                  x e 
              
            
          
          
            k
          
        
      
    
      displaystyle   tilde   mathbf  y      k  
  



  
    
      
        
          
            P
          
          
            k
              x     
            k
          
        
         
        cov
          x     
        
           
          
            
              
                x
              
              
                k
              
            
              x     
            
               
              
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
                 
                
                  
                    K
                  
                  
                    k
                  
                
                
                   
                  
                    
                      
                        z
                      
                      
                        k
                      
                    
                      x     
                    
                      
                        H
                      
                      
                        k
                      
                    
                    
                      
                        
                          
                            
                              x
                            
                              x e 
                          
                        
                      
                      
                        k
                          x     
                        k
                          x     
                         
                      
                    
                  
                   
                
              
               
            
          
           
        
      
    
      displaystyle  mathbf  P    k mid k   operatorname  cov   left  mathbf  x    k   left   hat   mathbf  x      k mid k     mathbf  K    k  left  mathbf  z    k   mathbf  H    k   hat   mathbf  x      k mid k    right  right  right  
  

and 
  
    
      
        
          
            z
          
          
            k
          
        
      
    
      displaystyle  mathbf  z    k  
  



  
    
      
        
          
            P
          
          
            k
              x     
            k
          
        
         
        cov
          x     
        
           
          
            
              
                x
              
              
                k
              
            
              x     
            
               
              
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
                 
                
                  
                    K
                  
                  
                    k
                  
                
                
                   
                  
                    
                      
                        H
                      
                      
                        k
                      
                    
                    
                      
                        x
                      
                      
                        k
                      
                    
                     
                    
                      
                        v
                      
                      
                        k
                      
                    
                      x     
                    
                      
                        H
                      
                      
                        k
                      
                    
                    
                      
                        
                          
                            
                              x
                            
                              x e 
                          
                        
                      
                      
                        k
                          x     
                        k
                          x     
                         
                      
                    
                  
                   
                
              
               
            
          
           
        
      
    
      displaystyle  mathbf  P    k mid k   operatorname  cov   left  mathbf  x    k   left   hat   mathbf  x      k mid k     mathbf  K    k  left  mathbf  H    k  mathbf  x    k   mathbf  v    k   mathbf  H    k   hat   mathbf  x      k mid k    right  right  right  
  

and by collecting the error vectors we get


  
    
      
        
          
            P
          
          
            k
              x     
            k
          
        
         
        cov
          x     
        
           
          
            
               
              
                
                  I
                
                  x     
                
                  
                    K
                  
                  
                    k
                  
                
                
                  
                    H
                  
                  
                    k
                  
                
              
               
            
            
               
              
                
                  
                    x
                  
                  
                    k
                  
                
                  x     
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
              
               
            
              x     
            
              
                K
              
              
                k
              
            
            
              
                v
              
              
                k
              
            
          
           
        
      
    
      displaystyle  mathbf  P    k mid k   operatorname  cov   left  left  mathbf  I    mathbf  K    k  mathbf  H    k  right  left  mathbf  x    k    hat   mathbf  x      k mid k    right   mathbf  K    k  mathbf  v    k  right  
  

Since the measurement error vk is uncorrelated with the other terms  this becomes


  
    
      
        
          
            P
          
          
            k
              x     
            k
          
        
         
        cov
          x     
        
           
          
            
               
              
                
                  I
                
                  x     
                
                  
                    K
                  
                  
                    k
                  
                
                
                  
                    H
                  
                  
                    k
                  
                
              
               
            
            
               
              
                
                  
                    x
                  
                  
                    k
                  
                
                  x     
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
              
               
            
          
           
        
         
        cov
          x     
        
           
          
            
              
                K
              
              
                k
              
            
            
              
                v
              
              
                k
              
            
          
           
        
      
    
      displaystyle  mathbf  P    k mid k   operatorname  cov   left  left  mathbf  I    mathbf  K    k  mathbf  H    k  right  left  mathbf  x    k    hat   mathbf  x      k mid k    right  right   operatorname  cov   left  mathbf  K    k  mathbf  v    k  right  
  

by the properties of vector covariance this becomes


  
    
      
        
          
            P
          
          
            k
              x     
            k
          
        
         
        
           
          
            
              I
            
              x     
            
              
                K
              
              
                k
              
            
            
              
                H
              
              
                k
              
            
          
           
        
        cov
          x     
        
           
          
            
              
                x
              
              
                k
              
            
              x     
            
              
                
                  
                    
                      x
                    
                      x e 
                  
                
              
              
                k
                  x     
                k
                  x     
                 
              
            
          
           
        
        
          
             
            
              
                I
              
                x     
              
                
                  K
                
                
                  k
                
              
              
                
                  H
                
                
                  k
                
              
            
             
          
          
            
              T
            
          
        
         
        
          
            K
          
          
            k
          
        
        cov
          x     
        
           
          
            
              v
            
            
              k
            
          
           
        
        
          
            K
          
          
            k
          
          
            
              T
            
          
        
      
    
      displaystyle  mathbf  P    k mid k   left  mathbf  I    mathbf  K    k  mathbf  H    k  right  operatorname  cov   left  mathbf  x    k    hat   mathbf  x      k mid k    right  left  mathbf  I    mathbf  K    k  mathbf  H    k  right    textsf  T    mathbf  K    k  operatorname  cov   left  mathbf  v    k  right  mathbf  K    k    textsf  T   
  

which  using our invariant on Pk             k   and the definition of Rk becomes


  
    
      
        
          
            P
          
          
            k
              x     
            k
          
        
         
        
           
          
            
              I
            
              x     
            
              
                K
              
              
                k
              
            
            
              
                H
              
              
                k
              
            
          
           
        
        
          
            P
          
          
            k
              x     
            k
              x     
             
          
        
        
          
             
            
              
                I
              
                x     
              
                
                  K
                
                
                  k
                
              
              
                
                  H
                
                
                  k
                
              
            
             
          
          
            
              T
            
          
        
         
        
          
            K
          
          
            k
          
        
        
          
            R
          
          
            k
          
        
        
          
            K
          
          
            k
          
          
            
              T
            
          
        
      
    
      displaystyle  mathbf  P    k mid k   left  mathbf  I    mathbf  K    k  mathbf  H    k  right  mathbf  P    k mid k    left  mathbf  I    mathbf  K    k  mathbf  H    k  right    textsf  T    mathbf  K    k  mathbf  R    k  mathbf  K    k    textsf  T   
  

This formula  sometimes known as the Joseph form of the covariance update equation  is valid for any value of Kk  It turns out that if Kk is the optimal Kalman gain  this can be simplified further as shown below 

Kalman gain derivation edit 
The Kalman filter is a  minimum mean square error  MMSE  estimator  The error in the a posteriori state estimation is


  
    
      
        
          
            x
          
          
            k
          
        
          x     
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            k
              x     
            k
          
        
      
    
      displaystyle  mathbf  x    k    hat   mathbf  x      k mid k  
  

We seek to minimize the expected value of the square of the magnitude of this vector  
  
    
      
        E
          x     
        
           
          
            
                x     
              
                
                  
                    x
                  
                  
                    k
                  
                
                  x     
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    k
                    
                       
                    
                    k
                  
                
              
                x     
            
            
               
            
          
           
        
      
    
      displaystyle  operatorname  E   left  left   mathbf  x    k    hat   mathbf  x      k k  right       right  
  
  This is equivalent to minimizing the trace of the a posteriori estimate covariance matrix 
  
    
      
        
          
            P
          
          
            k
            
               
            
            k
          
        
      
    
      displaystyle  mathbf  P    k k  
  
  By expanding out the terms in the equation above and collecting  we get 


  
    
      
        
          
            
              
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                  
                
              
              
                
                 
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
                  x     
                
                  
                    K
                  
                  
                    k
                  
                
                
                  
                    H
                  
                  
                    k
                  
                
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
                  x     
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
                
                  
                    H
                  
                  
                    k
                  
                  
                    
                      T
                    
                  
                
                
                  
                    K
                  
                  
                    k
                  
                  
                    
                      T
                    
                  
                
                 
                
                  
                    K
                  
                  
                    k
                  
                
                
                   
                  
                    
                      
                        H
                      
                      
                        k
                      
                    
                    
                      
                        P
                      
                      
                        k
                          x     
                        k
                          x     
                         
                      
                    
                    
                      
                        H
                      
                      
                        k
                      
                      
                        
                          T
                        
                      
                    
                     
                    
                      
                        R
                      
                      
                        k
                      
                    
                  
                   
                
                
                  
                    K
                  
                  
                    k
                  
                  
                    
                      T
                    
                  
                
              
            
            
              
              
                
                 
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
                  x     
                
                  
                    K
                  
                  
                    k
                  
                
                
                  
                    H
                  
                  
                    k
                  
                
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
                  x     
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
                
                  
                    H
                  
                  
                    k
                  
                  
                    
                      T
                    
                  
                
                
                  
                    K
                  
                  
                    k
                  
                  
                    
                      T
                    
                  
                
                 
                
                  
                    K
                  
                  
                    k
                  
                
                
                  
                    S
                  
                  
                    k
                  
                
                
                  
                    K
                  
                  
                    k
                  
                  
                    
                      T
                    
                  
                
              
            
          
        
      
    
      displaystyle   begin aligned  mathbf  P    k mid k  amp   mathbf  P    k mid k     mathbf  K    k  mathbf  H    k  mathbf  P    k mid k     mathbf  P    k mid k    mathbf  H    k    textsf  T   mathbf  K    k    textsf  T    mathbf  K    k  left  mathbf  H    k  mathbf  P    k mid k    mathbf  H    k    textsf  T    mathbf  R    k  right  mathbf  K    k    textsf  T      pt  amp   mathbf  P    k mid k     mathbf  K    k  mathbf  H    k  mathbf  P    k mid k     mathbf  P    k mid k    mathbf  H    k    textsf  T   mathbf  K    k    textsf  T    mathbf  K    k  mathbf  S    k  mathbf  K    k    textsf  T   end aligned   
  

The trace is minimized when its matrix derivative with respect to the gain matrix is zero  Using the gradient matrix rules and the symmetry of the matrices involved we find that


  
    
      
        
          
            
                x     
              
              tr
                x     
               
              
                
                  P
                
                
                  k
                    x     
                  k
                
              
               
            
            
                x     
              
              
                
                  K
                
                
                  k
                
              
            
          
        
         
          x     
         
        
          
             
            
              
                
                  H
                
                
                  k
                
              
              
                
                  P
                
                
                  k
                    x     
                  k
                    x     
                   
                
              
            
             
          
          
            
              T
            
          
        
         
         
        
          
            K
          
          
            k
          
        
        
          
            S
          
          
            k
          
        
         
          
      
    
      displaystyle   frac   partial    operatorname  tr    mathbf  P    k mid k     partial    mathbf  K    k       left  mathbf  H    k  mathbf  P    k mid k    right    textsf  T     mathbf  K    k  mathbf  S    k     
  

Solving this for Kk yields the Kalman gain 


  
    
      
        
          
            
              
                
                  
                    K
                  
                  
                    k
                  
                
                
                  
                    S
                  
                  
                    k
                  
                
              
              
                
                 
                
                  
                     
                    
                      
                        
                          H
                        
                        
                          k
                        
                      
                      
                        
                          P
                        
                        
                          k
                            x     
                          k
                            x     
                           
                        
                      
                    
                     
                  
                  
                    
                      T
                    
                  
                
                 
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
                
                  
                    H
                  
                  
                    k
                  
                  
                    
                      T
                    
                  
                
              
            
            
              
                  x  d  
                
                  
                    K
                  
                  
                    k
                  
                
              
              
                
                 
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
                
                  
                    H
                  
                  
                    k
                  
                  
                    
                      T
                    
                  
                
                
                  
                    S
                  
                  
                    k
                  
                  
                      x     
                     
                  
                
              
            
          
        
      
    
      displaystyle   begin aligned  mathbf  K    k  mathbf  S    k  amp   left  mathbf  H    k  mathbf  P    k mid k    right    textsf  T    mathbf  P    k mid k    mathbf  H    k    textsf  T     Rightarrow  mathbf  K    k  amp   mathbf  P    k mid k    mathbf  H    k    textsf  T   mathbf  S    k       end aligned   
  

This gain  which is known as the optimal Kalman gain  is the one that yields MMSE estimates when used 

Simplification of the posteriori error covariance formula edit 
The formula used to calculate the a posteriori error covariance can be simplified when the Kalman gain equals the optimal value derived above  Multiplying both sides of our Kalman gain formula on the right by SkKkT  it follows that


  
    
      
        
          
            K
          
          
            k
          
        
        
          
            S
          
          
            k
          
        
        
          
            K
          
          
            k
          
          
            
              T
            
          
        
         
        
          
            P
          
          
            k
              x     
            k
              x     
             
          
        
        
          
            H
          
          
            k
          
          
            
              T
            
          
        
        
          
            K
          
          
            k
          
          
            
              T
            
          
        
      
    
      displaystyle  mathbf  K    k  mathbf  S    k  mathbf  K    k    textsf  T    mathbf  P    k mid k    mathbf  H    k    textsf  T   mathbf  K    k    textsf  T   
  

Referring back to our expanded formula for the a posteriori error covariance 


  
    
      
        
          
            P
          
          
            k
              x     
            k
          
        
         
        
          
            P
          
          
            k
              x     
            k
              x     
             
          
        
          x     
        
          
            K
          
          
            k
          
        
        
          
            H
          
          
            k
          
        
        
          
            P
          
          
            k
              x     
            k
              x     
             
          
        
          x     
        
          
            P
          
          
            k
              x     
            k
              x     
             
          
        
        
          
            H
          
          
            k
          
          
            
              T
            
          
        
        
          
            K
          
          
            k
          
          
            
              T
            
          
        
         
        
          
            K
          
          
            k
          
        
        
          
            S
          
          
            k
          
        
        
          
            K
          
          
            k
          
          
            
              T
            
          
        
      
    
      displaystyle  mathbf  P    k mid k   mathbf  P    k mid k     mathbf  K    k  mathbf  H    k  mathbf  P    k mid k     mathbf  P    k mid k    mathbf  H    k    textsf  T   mathbf  K    k    textsf  T    mathbf  K    k  mathbf  S    k  mathbf  K    k    textsf  T   
  

we find the last two terms cancel out  giving


  
    
      
        
          
            P
          
          
            k
              x     
            k
          
        
         
        
          
            P
          
          
            k
              x     
            k
              x     
             
          
        
          x     
        
          
            K
          
          
            k
          
        
        
          
            H
          
          
            k
          
        
        
          
            P
          
          
            k
              x     
            k
              x     
             
          
        
         
         
        
          I
        
          x     
        
          
            K
          
          
            k
          
        
        
          
            H
          
          
            k
          
        
         
        
          
            P
          
          
            k
              x     
            k
              x     
             
          
        
      
    
      displaystyle  mathbf  P    k mid k   mathbf  P    k mid k     mathbf  K    k  mathbf  H    k  mathbf  P    k mid k      mathbf  I    mathbf  K    k  mathbf  H    k   mathbf  P    k mid k    
  

This formula is computationally cheaper and thus nearly always used in practice  but is only correct for the optimal gain  If arithmetic precision is unusually low causing problems with numerical stability  or if a non optimal Kalman gain is deliberately used  this simplification cannot be applied  the a posteriori error covariance formula as derived above  Joseph form  must be used 

Sensitivity analysis edit 
This section needs additional citations for verification  Please help improve this article by adding citations to reliable sources     in this section  Unsourced material may be challenged and removed    December        Learn how and when to remove this message 
The Kalman filtering equations provide an estimate of the state 
  
    
      
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            k
              x     
            k
          
        
      
    
      displaystyle   hat   mathbf  x      k mid k  
  
 and its error covariance 
  
    
      
        
          
            P
          
          
            k
              x     
            k
          
        
      
    
      displaystyle  mathbf  P    k mid k  
  
 recursively  The estimate and its quality depend on the system parameters and the noise statistics fed as inputs to the estimator  This section analyzes the effect of uncertainties in the statistical inputs to the filter              In the absence of reliable statistics or the true values of noise covariance matrices 
  
    
      
        
          
            Q
          
          
            k
          
        
      
    
      displaystyle  mathbf  Q    k  
  
 and 
  
    
      
        
          
            R
          
          
            k
          
        
      
    
      displaystyle  mathbf  R    k  
  
  the expression


  
    
      
        
          
            P
          
          
            k
              x     
            k
          
        
         
        
           
          
            
              I
            
              x     
            
              
                K
              
              
                k
              
            
            
              
                H
              
              
                k
              
            
          
           
        
        
          
            P
          
          
            k
              x     
            k
              x     
             
          
        
        
          
             
            
              
                I
              
                x     
              
                
                  K
                
                
                  k
                
              
              
                
                  H
                
                
                  k
                
              
            
             
          
          
            
              T
            
          
        
         
        
          
            K
          
          
            k
          
        
        
          
            R
          
          
            k
          
        
        
          
            K
          
          
            k
          
          
            
              T
            
          
        
      
    
      displaystyle  mathbf  P    k mid k   left  mathbf  I    mathbf  K    k  mathbf  H    k  right  mathbf  P    k mid k    left  mathbf  I    mathbf  K    k  mathbf  H    k  right    textsf  T    mathbf  K    k  mathbf  R    k  mathbf  K    k    textsf  T   
  

no longer provides the actual error covariance  In other words  
  
    
      
        
          
            P
          
          
            k
              x     
            k
          
        
          x     
        E
        
           
          
            
               
              
                
                  
                    x
                  
                  
                    k
                  
                
                  x     
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                    k
                  
                
              
               
            
            
              
                 
                
                  
                    
                      x
                    
                    
                      k
                    
                  
                    x     
                  
                    
                      
                        
                          
                            x
                          
                            x e 
                        
                      
                    
                    
                      k
                        x     
                      k
                    
                  
                
                 
              
              
                
                  T
                
              
            
          
           
        
      
    
      displaystyle  mathbf  P    k mid k  neq E left  left  mathbf  x    k    hat   mathbf  x      k mid k  right  left  mathbf  x    k    hat   mathbf  x      k mid k  right    textsf  T   right  
  
   In most real time applications  the covariance matrices that are used in designing the Kalman filter are different from the actual  true  noise covariances matrices      citation needed      This sensitivity analysis describes the behavior of the estimation error covariance when the noise covariances as well as the system matrices 
  
    
      
        
          
            F
          
          
            k
          
        
      
    
      displaystyle  mathbf  F    k  
  
 and 
  
    
      
        
          
            H
          
          
            k
          
        
      
    
      displaystyle  mathbf  H    k  
  
 that are fed as inputs to the filter are incorrect  Thus  the sensitivity analysis describes the robustness  or sensitivity  of the estimator to misspecified statistical and parametric inputs to the estimator 
This discussion is limited to the error sensitivity analysis for the case of statistical uncertainties  Here the actual noise covariances are denoted by 
  
    
      
        
          
            Q
          
          
            k
          
          
            a
          
        
      
    
      displaystyle  mathbf  Q    k   a  
  
 and 
  
    
      
        
          
            R
          
          
            k
          
          
            a
          
        
      
    
      displaystyle  mathbf  R    k   a  
  
 respectively  whereas the design values used in the estimator are 
  
    
      
        
          
            Q
          
          
            k
          
        
      
    
      displaystyle  mathbf  Q    k  
  
 and 
  
    
      
        
          
            R
          
          
            k
          
        
      
    
      displaystyle  mathbf  R    k  
  
 respectively  The actual error covariance is denoted by 
  
    
      
        
          
            P
          
          
            k
              x     
            k
          
          
            a
          
        
      
    
      displaystyle  mathbf  P    k mid k   a  
  
 and 
  
    
      
        
          
            P
          
          
            k
              x     
            k
          
        
      
    
      displaystyle  mathbf  P    k mid k  
  
 as computed by the Kalman filter is referred to as the Riccati variable  When 
  
    
      
        
          
            Q
          
          
            k
          
        
          x     
        
          
            Q
          
          
            k
          
          
            a
          
        
      
    
      displaystyle  mathbf  Q    k  equiv  mathbf  Q    k   a  
  
 and 
  
    
      
        
          
            R
          
          
            k
          
        
          x     
        
          
            R
          
          
            k
          
          
            a
          
        
      
    
      displaystyle  mathbf  R    k  equiv  mathbf  R    k   a  
  
  this means that 
  
    
      
        
          
            P
          
          
            k
              x     
            k
          
        
         
        
          
            P
          
          
            k
              x     
            k
          
          
            a
          
        
      
    
      displaystyle  mathbf  P    k mid k   mathbf  P    k mid k   a  
  
  While computing the actual error covariance using 
  
    
      
        
          
            P
          
          
            k
              x     
            k
          
          
            a
          
        
         
        E
        
           
          
            
               
              
                
                  
                    x
                  
                  
                    k
                  
                
                  x     
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                    k
                  
                
              
               
            
            
              
                 
                
                  
                    
                      x
                    
                    
                      k
                    
                  
                    x     
                  
                    
                      
                        
                          
                            x
                          
                            x e 
                        
                      
                    
                    
                      k
                        x     
                      k
                    
                  
                
                 
              
              
                
                  T
                
              
            
          
           
        
      
    
      displaystyle  mathbf  P    k mid k   a  E left  left  mathbf  x    k    hat   mathbf  x      k mid k  right  left  mathbf  x    k    hat   mathbf  x      k mid k  right    textsf  T   right  
  
  substituting for 
  
    
      
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            k
              x     
            k
          
        
      
    
      displaystyle   widehat   mathbf  x      k mid k  
  
 and using the fact that 
  
    
      
        E
        
           
          
            
              
                w
              
              
                k
              
            
            
              
                w
              
              
                k
              
              
                
                  T
                
              
            
          
           
        
         
        
          
            Q
          
          
            k
          
          
            a
          
        
      
    
      displaystyle E left  mathbf  w    k  mathbf  w    k    textsf  T   right   mathbf  Q    k   a  
  
 and 
  
    
      
        E
        
           
          
            
              
                v
              
              
                k
              
            
            
              
                v
              
              
                k
              
              
                
                  T
                
              
            
          
           
        
         
        
          
            R
          
          
            k
          
          
            a
          
        
      
    
      displaystyle E left  mathbf  v    k  mathbf  v    k    textsf  T   right   mathbf  R    k   a  
  
  results in the following recursive equations for 
  
    
      
        
          
            P
          
          
            k
              x     
            k
          
          
            a
          
        
      
    
      displaystyle  mathbf  P    k mid k   a  
  
       


  
    
      
        
          
            P
          
          
            k
              x     
            k
              x     
             
          
          
            a
          
        
         
        
          
            F
          
          
            k
          
        
        
          
            P
          
          
            k
              x     
             
              x     
            k
              x     
             
          
          
            a
          
        
        
          
            F
          
          
            k
          
          
            
              T
            
          
        
         
        
          
            Q
          
          
            k
          
          
            a
          
        
      
    
      displaystyle  mathbf  P    k mid k     a   mathbf  F    k  mathbf  P    k   mid k     a  mathbf  F    k    textsf  T    mathbf  Q    k   a  
  

and


  
    
      
        
          
            P
          
          
            k
              x     
            k
          
          
            a
          
        
         
        
           
          
            
              I
            
              x     
            
              
                K
              
              
                k
              
            
            
              
                H
              
              
                k
              
            
          
           
        
        
          
            P
          
          
            k
              x     
            k
              x     
             
          
          
            a
          
        
        
          
             
            
              
                I
              
                x     
              
                
                  K
                
                
                  k
                
              
              
                
                  H
                
                
                  k
                
              
            
             
          
          
            
              T
            
          
        
         
        
          
            K
          
          
            k
          
        
        
          
            R
          
          
            k
          
          
            a
          
        
        
          
            K
          
          
            k
          
          
            
              T
            
          
        
      
    
      displaystyle  mathbf  P    k mid k   a   left  mathbf  I    mathbf  K    k  mathbf  H    k  right  mathbf  P    k mid k     a  left  mathbf  I    mathbf  K    k  mathbf  H    k  right    textsf  T    mathbf  K    k  mathbf  R    k   a  mathbf  K    k    textsf  T   
  

While computing 
  
    
      
        
          
            P
          
          
            k
              x     
            k
          
        
      
    
      displaystyle  mathbf  P    k mid k  
  
  by design the filter implicitly assumes that 
  
    
      
        E
        
           
          
            
              
                w
              
              
                k
              
            
            
              
                w
              
              
                k
              
              
                
                  T
                
              
            
          
           
        
         
        
          
            Q
          
          
            k
          
        
      
    
      displaystyle E left  mathbf  w    k  mathbf  w    k    textsf  T   right   mathbf  Q    k  
  
 and 
  
    
      
        E
        
           
          
            
              
                v
              
              
                k
              
            
            
              
                v
              
              
                k
              
              
                
                  T
                
              
            
          
           
        
         
        
          
            R
          
          
            k
          
        
      
    
      displaystyle E left  mathbf  v    k  mathbf  v    k    textsf  T   right   mathbf  R    k  
  
  The recursive expressions for 
  
    
      
        
          
            P
          
          
            k
              x     
            k
          
          
            a
          
        
      
    
      displaystyle  mathbf  P    k mid k   a  
  
 and 
  
    
      
        
          
            P
          
          
            k
              x     
            k
          
        
      
    
      displaystyle  mathbf  P    k mid k  
  
 are identical except for the presence of 
  
    
      
        
          
            Q
          
          
            k
          
          
            a
          
        
      
    
      displaystyle  mathbf  Q    k   a  
  
 and 
  
    
      
        
          
            R
          
          
            k
          
          
            a
          
        
      
    
      displaystyle  mathbf  R    k   a  
  
 in place of the design values 
  
    
      
        
          
            Q
          
          
            k
          
        
      
    
      displaystyle  mathbf  Q    k  
  
 and 
  
    
      
        
          
            R
          
          
            k
          
        
      
    
      displaystyle  mathbf  R    k  
  
 respectively  Researches have been done to analyze Kalman filter system s robustness             

Factored form edit 
One problem with the Kalman filter is its numerical stability   If the process noise covariance Qk is small  round off error often causes a small positive eigenvalue of the state covariance matrix P to be computed as a negative number   This renders the numerical representation of P indefinite  while its true form is positive definite 
Positive definite matrices have the property that they have a factorization into the product of a non singular  lower triangular matrix S  and its transpose         P             S ST   The factor S can be computed efficiently using the Cholesky factorization algorithm  This product form of the covariance matrix P is guaranteed to be symmetric  and for all    lt   k  lt   n  the k th diagonal element  Pkk is equal to the euclidean norm of the k th row of S  which is necessarily positive  An equivalent form  which avoids many of the square root operations involved in the Cholesky factorization algorithm  yet preserves the desirable numerical properties  is the U D decomposition form  P             U D UT  where U is a unit triangular matrix  with unit diagonal   and D is a diagonal matrix 
Between the two  the U D factorization uses the same amount of storage  and somewhat less computation  and is the most commonly used triangular factorization    Early literature on the relative efficiency is somewhat misleading  as it assumed that square roots were much more time consuming than divisions                                   while on   st century computers they are only slightly more expensive  
Efficient algorithms for the Kalman prediction and update steps in the factored form were developed by G  J  Bierman and C  L  Thornton                         
The L D LT decomposition of the innovation covariance matrix Sk is the basis for another type of numerically efficient and robust square root filter              The algorithm starts with the LU decomposition as implemented in the Linear Algebra PACKage  LAPACK   These results are further factored into the L D LT structure with methods given by Golub and Van Loan  algorithm        for a symmetric nonsingular matrix              Any singular covariance matrix is pivoted so that the first diagonal partition is nonsingular and well conditioned  The pivoting algorithm must retain any portion of the innovation covariance matrix directly corresponding to observed state variables Hk xk k   that are associated with auxiliary observations in
yk  The l d lt square root filter requires orthogonalization of the observation vector                          This may be done with the inverse square root of the covariance matrix for the auxiliary variables using Method   in Higham        p                        

Parallel form edit 
The Kalman filter is efficient for sequential data processing on central processing units  CPUs   but in its original form it is inefficient on parallel architectures such as graphics processing units  GPUs   It is however possible to express the filter update routine in terms of an associative operator using the formulation in S rkk  and Garc a Fern ndez                     The filter solution can then be retrieved by the use of a prefix sum algorithm which can be efficiently implemented on GPU              This reduces the computational complexity from 
  
    
      
        O
         
        N
         
      
    
      displaystyle O N  
  
 in the number of time steps to 
  
    
      
        O
         
        log
          x     
         
        N
         
         
      
    
      displaystyle O  log N   
  
 

Relationship to recursive Bayesian estimation edit 
The Kalman filter can be presented as one of the simplest dynamic Bayesian networks  The Kalman filter calculates estimates of the true values of states recursively over time using incoming measurements and a mathematical process model  Similarly  recursive Bayesian estimation calculates estimates of an unknown probability density function  PDF  recursively over time using incoming measurements and a mathematical process model             
In recursive Bayesian estimation  the true state is assumed to be an unobserved Markov process  and the measurements are the observed states of a hidden Markov model  HMM  

hidden markov model
Because of the Markov assumption  the true state is conditionally independent of all earlier states given the immediately previous state 


  
    
      
        p
         
        
          
            x
          
          
            k
          
        
          x     
        
          
            x
          
          
             
          
        
         
          x     
         
        
          
            x
          
          
            k
              x     
             
          
        
         
         
        p
         
        
          
            x
          
          
            k
          
        
          x     
        
          
            x
          
          
            k
              x     
             
          
        
         
      
    
      displaystyle p  mathbf  x    k  mid  mathbf  x        dots   mathbf  x    k     p  mathbf  x    k  mid  mathbf  x    k     
  

Similarly  the measurement at the k th timestep is dependent only upon the current state and is conditionally independent of all other states given the current state 


  
    
      
        p
         
        
          
            z
          
          
            k
          
        
          x     
        
          
            x
          
          
             
          
        
         
          x     
         
        
          
            x
          
          
            k
          
        
         
         
        p
         
        
          
            z
          
          
            k
          
        
          x     
        
          
            x
          
          
            k
          
        
         
      
    
      displaystyle p  mathbf  z    k  mid  mathbf  x        dots   mathbf  x    k   p  mathbf  z    k  mid  mathbf  x    k   
  

Using these assumptions the probability distribution over all states of the hidden Markov model can be written simply as 


  
    
      
        p
        
           
          
            
              
                x
              
              
                 
              
            
             
              x     
             
            
              
                x
              
              
                k
              
            
             
            
              
                z
              
              
                 
              
            
             
              x     
             
            
              
                z
              
              
                k
              
            
          
           
        
         
        p
        
           
          
            
              x
            
            
               
            
          
           
        
        
            x   f 
          
            i
             
             
          
          
            k
          
        
        p
        
           
          
            
              
                z
              
              
                i
              
            
              x     
            
              
                x
              
              
                i
              
            
          
           
        
        p
        
           
          
            
              
                x
              
              
                i
              
            
              x     
            
              
                x
              
              
                i
                  x     
                 
              
            
          
           
        
      
    
      displaystyle p left  mathbf  x        dots   mathbf  x    k   mathbf  z        dots   mathbf  z    k  right  p left  mathbf  x       right  prod   i     k p left  mathbf  z    i  mid  mathbf  x    i  right p left  mathbf  x    i  mid  mathbf  x    i    right  
  

However  when a Kalman filter is used to estimate the state x  the probability distribution of interest is that associated with the current states conditioned on the measurements up to the current timestep  This is achieved by marginalizing out the previous states and dividing by the probability of the measurement set 
This results in the predict and update phases of the Kalman filter written probabilistically  The probability distribution associated with the predicted state is the sum  integral  of the products of the probability distribution associated with the transition from the  k                th timestep to the k th and the probability distribution associated with the previous state  over all possible 
  
    
      
        
          x
          
            k
              x     
             
          
        
      
    
      displaystyle x  k    
  
 


  
    
      
        p
        
           
          
            
              
                x
              
              
                k
              
            
              x     
            
              
                Z
              
              
                k
                  x     
                 
              
            
          
           
        
         
          x   b 
        p
        
           
          
            
              
                x
              
              
                k
              
            
              x     
            
              
                x
              
              
                k
                  x     
                 
              
            
          
           
        
        p
        
           
          
            
              
                x
              
              
                k
                  x     
                 
              
            
              x     
            
              
                Z
              
              
                k
                  x     
                 
              
            
          
           
        
        
        d
        
          
            x
          
          
            k
              x     
             
          
        
      
    
      displaystyle p left  mathbf  x    k  mid  mathbf  Z    k    right   int p left  mathbf  x    k  mid  mathbf  x    k    right p left  mathbf  x    k    mid  mathbf  Z    k    right   d mathbf  x    k    
  

The measurement set up to time t is


  
    
      
        
          
            Z
          
          
            t
          
        
         
        
           
          
            
              
                z
              
              
                 
              
            
             
              x     
             
            
              
                z
              
              
                t
              
            
          
           
        
      
    
      displaystyle  mathbf  Z    t   left   mathbf  z        dots   mathbf  z    t  right   
  

The probability distribution of the update is proportional to the product of the measurement likelihood and the predicted state 


  
    
      
        p
        
           
          
            
              
                x
              
              
                k
              
            
              x     
            
              
                Z
              
              
                k
              
            
          
           
        
         
        
          
            
              p
              
                 
                
                  
                    
                      z
                    
                    
                      k
                    
                  
                    x     
                  
                    
                      x
                    
                    
                      k
                    
                  
                
                 
              
              p
              
                 
                
                  
                    
                      x
                    
                    
                      k
                    
                  
                    x     
                  
                    
                      Z
                    
                    
                      k
                        x     
                       
                    
                  
                
                 
              
            
            
              p
              
                 
                
                  
                    
                      z
                    
                    
                      k
                    
                  
                    x     
                  
                    
                      Z
                    
                    
                      k
                        x     
                       
                    
                  
                
                 
              
            
          
        
      
    
      displaystyle p left  mathbf  x    k  mid  mathbf  Z    k  right    frac  p left  mathbf  z    k  mid  mathbf  x    k  right p left  mathbf  x    k  mid  mathbf  Z    k    right   p left  mathbf  z    k  mid  mathbf  Z    k    right    
  

The denominator


  
    
      
        p
        
           
          
            
              
                z
              
              
                k
              
            
              x     
            
              
                Z
              
              
                k
                  x     
                 
              
            
          
           
        
         
          x   b 
        p
        
           
          
            
              
                z
              
              
                k
              
            
              x     
            
              
                x
              
              
                k
              
            
          
           
        
        p
        
           
          
            
              
                x
              
              
                k
              
            
              x     
            
              
                Z
              
              
                k
                  x     
                 
              
            
          
           
        
        
        d
        
          
            x
          
          
            k
          
        
      
    
      displaystyle p left  mathbf  z    k  mid  mathbf  Z    k    right   int p left  mathbf  z    k  mid  mathbf  x    k  right p left  mathbf  x    k  mid  mathbf  Z    k    right   d mathbf  x    k  
  

is a normalization term 
The remaining probability density functions are


  
    
      
        
          
            
              
                p
                
                   
                  
                    
                      
                        x
                      
                      
                        k
                      
                    
                      x     
                    
                      
                        x
                      
                      
                        k
                          x     
                         
                      
                    
                  
                   
                
              
              
                
                 
                
                  
                    N
                  
                
                
                   
                  
                    
                      
                        F
                      
                      
                        k
                      
                    
                    
                      
                        x
                      
                      
                        k
                          x     
                         
                      
                    
                     
                    
                      
                        Q
                      
                      
                        k
                      
                    
                  
                   
                
              
            
            
              
                p
                
                   
                  
                    
                      
                        z
                      
                      
                        k
                      
                    
                      x     
                    
                      
                        x
                      
                      
                        k
                      
                    
                  
                   
                
              
              
                
                 
                
                  
                    N
                  
                
                
                   
                  
                    
                      
                        H
                      
                      
                        k
                      
                    
                    
                      
                        x
                      
                      
                        k
                      
                    
                     
                    
                      
                        R
                      
                      
                        k
                      
                    
                  
                   
                
              
            
            
              
                p
                
                   
                  
                    
                      
                        x
                      
                      
                        k
                          x     
                         
                      
                    
                      x     
                    
                      
                        Z
                      
                      
                        k
                          x     
                         
                      
                    
                  
                   
                
              
              
                
                 
                
                  
                    N
                  
                
                
                   
                  
                    
                      
                        
                          
                            
                              x
                            
                              x e 
                          
                        
                      
                      
                        k
                          x     
                         
                      
                    
                     
                    
                      
                        P
                      
                      
                        k
                          x     
                         
                      
                    
                  
                   
                
              
            
          
        
      
    
      displaystyle   begin aligned p left  mathbf  x    k  mid  mathbf  x    k    right  amp    mathcal  N   left  mathbf  F    k  mathbf  x    k     mathbf  Q    k  right   p left  mathbf  z    k  mid  mathbf  x    k  right  amp    mathcal  N   left  mathbf  H    k  mathbf  x    k   mathbf  R    k  right   p left  mathbf  x    k    mid  mathbf  Z    k    right  amp    mathcal  N   left   hat   mathbf  x      k     mathbf  P    k    right  end aligned   
  

The PDF at the previous timestep is assumed inductively to be the estimated state and covariance  This is justified because  as an optimal estimator  the Kalman filter makes best use of the measurements  therefore the PDF for 
  
    
      
        
          
            x
          
          
            k
          
        
      
    
      displaystyle  mathbf  x    k  
  
  given the measurements 
  
    
      
        
          
            Z
          
          
            k
          
        
      
    
      displaystyle  mathbf  Z    k  
  
 is the Kalman filter estimate 

Marginal likelihood edit 
Related to the recursive Bayesian interpretation described above  the Kalman filter can be viewed as a generative model  i e   a process for generating a stream of random observations z    z   z   z         Specifically  the process is

Sample a hidden state 
  
    
      
        
          
            x
          
          
             
          
        
      
    
      displaystyle  mathbf  x       
  
 from the Gaussian prior distribution 
  
    
      
        p
        
           
          
            
              x
            
            
               
            
          
           
        
         
        
          
            N
          
        
        
           
          
            
              
                
                  
                    
                      x
                    
                      x e 
                  
                
              
              
                 
                  x     
                 
              
            
             
            
              
                P
              
              
                 
                  x     
                 
              
            
          
           
        
      
    
      displaystyle p left  mathbf  x       right    mathcal  N   left   hat   mathbf  x        mid     mathbf  P      mid    right  
  
 
Sample an observation 
  
    
      
        
          
            z
          
          
             
          
        
      
    
      displaystyle  mathbf  z       
  
 from the observation model 
  
    
      
        p
        
           
          
            
              
                z
              
              
                 
              
            
              x     
            
              
                x
              
              
                 
              
            
          
           
        
         
        
          
            N
          
        
        
           
          
            
              
                H
              
              
                 
              
            
            
              
                x
              
              
                 
              
            
             
            
              
                R
              
              
                 
              
            
          
           
        
      
    
      displaystyle p left  mathbf  z       mid  mathbf  x       right    mathcal  N   left  mathbf  H       mathbf  x        mathbf  R       right  
  
 
For 
  
    
      
        k
         
         
         
         
         
         
         
          x     
      
    
      displaystyle k        ldots  
  
  do
Sample the next hidden state 
  
    
      
        
          
            x
          
          
            k
          
        
      
    
      displaystyle  mathbf  x    k  
  
 from the transition model 
  
    
      
        p
        
           
          
            
              
                x
              
              
                k
              
            
              x     
            
              
                x
              
              
                k
                  x     
                 
              
            
          
           
        
         
        
          
            N
          
        
        
           
          
            
              
                F
              
              
                k
              
            
            
              
                x
              
              
                k
                  x     
                 
              
            
             
            
              
                B
              
              
                k
              
            
            
              
                u
              
              
                k
              
            
             
            
              
                Q
              
              
                k
              
            
          
           
        
         
      
    
      displaystyle p left  mathbf  x    k  mid  mathbf  x    k    right    mathcal  N   left  mathbf  F    k  mathbf  x    k     mathbf  B    k  mathbf  u    k   mathbf  Q    k  right   
  

Sample an observation 
  
    
      
        
          
            z
          
          
            k
          
        
      
    
      displaystyle  mathbf  z    k  
  
 from the observation model 
  
    
      
        p
        
           
          
            
              
                z
              
              
                k
              
            
              x     
            
              
                x
              
              
                k
              
            
          
           
        
         
        
          
            N
          
        
        
           
          
            
              
                H
              
              
                k
              
            
            
              
                x
              
              
                k
              
            
             
            
              
                R
              
              
                k
              
            
          
           
        
         
      
    
      displaystyle p left  mathbf  z    k  mid  mathbf  x    k  right    mathcal  N   left  mathbf  H    k  mathbf  x    k   mathbf  R    k  right   
  

This process has identical structure to the hidden Markov model  except that the discrete state and observations are replaced with continuous variables sampled from Gaussian distributions 
In some applications  it is useful to compute the probability that a Kalman filter with a given set of parameters  prior distribution  transition and observation models  and control inputs  would generate a particular observed signal  This probability is known as the marginal likelihood because it integrates over   marginalizes out   the values of the hidden state variables  so it can be computed using only the observed signal  The marginal likelihood can be useful to evaluate different parameter choices  or to compare the Kalman filter against other models using Bayesian model comparison 
It is straightforward to compute the marginal likelihood as a side effect of the recursive filtering computation  By the chain rule  the likelihood can be factored as the product of the probability of each observation given previous observations 


  
    
      
        p
         
        
          z
        
         
         
        
            x   f 
          
            k
             
             
          
          
            T
          
        
        p
        
           
          
            
              
                z
              
              
                k
              
            
              x     
            
              
                z
              
              
                k
                  x     
                 
              
            
             
              x     
             
            
              
                z
              
              
                 
              
            
          
           
        
      
    
      displaystyle p  mathbf  z     prod   k     T p left  mathbf  z    k  mid  mathbf  z    k     ldots   mathbf  z       right  
  
 
and because the Kalman filter describes a Markov process  all relevant information from previous observations is contained in the current state estimate 
  
    
      
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            k
              x     
            k
              x     
             
          
        
         
        
          
            P
          
          
            k
              x     
            k
              x     
             
          
        
         
      
    
      displaystyle   hat   mathbf  x      k mid k     mathbf  P    k mid k     
  
 Thus the marginal likelihood is given by


  
    
      
        
          
            
              
                p
                 
                
                  z
                
                 
              
              
                
                 
                
                    x   f 
                  
                    k
                     
                     
                  
                  
                    T
                  
                
                  x   b 
                p
                
                   
                  
                    
                      
                        z
                      
                      
                        k
                      
                    
                      x     
                    
                      
                        x
                      
                      
                        k
                      
                    
                  
                   
                
                p
                
                   
                  
                    
                      
                        x
                      
                      
                        k
                      
                    
                      x     
                    
                      
                        z
                      
                      
                        k
                          x     
                         
                      
                    
                     
                      x     
                     
                    
                      
                        z
                      
                      
                         
                      
                    
                  
                   
                
                d
                
                  
                    x
                  
                  
                    k
                  
                
              
            
            
              
              
                
                 
                
                    x   f 
                  
                    k
                     
                     
                  
                  
                    T
                  
                
                  x   b 
                
                  
                    N
                  
                
                
                   
                  
                    
                      
                        z
                      
                      
                        k
                      
                    
                     
                    
                      
                        H
                      
                      
                        k
                      
                    
                    
                      
                        x
                      
                      
                        k
                      
                    
                     
                    
                      
                        R
                      
                      
                        k
                      
                    
                  
                   
                
                
                  
                    N
                  
                
                
                   
                  
                    
                      
                        x
                      
                      
                        k
                      
                    
                     
                    
                      
                        
                          
                            
                              x
                            
                              x e 
                          
                        
                      
                      
                        k
                          x     
                        k
                          x     
                         
                      
                    
                     
                    
                      
                        P
                      
                      
                        k
                          x     
                        k
                          x     
                         
                      
                    
                  
                   
                
                d
                
                  
                    x
                  
                  
                    k
                  
                
              
            
            
              
              
                
                 
                
                    x   f 
                  
                    k
                     
                     
                  
                  
                    T
                  
                
                
                  
                    N
                  
                
                
                   
                  
                    
                      
                        z
                      
                      
                        k
                      
                    
                     
                    
                      
                        H
                      
                      
                        k
                      
                    
                    
                      
                        
                          
                            
                              x
                            
                              x e 
                          
                        
                      
                      
                        k
                          x     
                        k
                          x     
                         
                      
                    
                     
                    
                      
                        R
                      
                      
                        k
                      
                    
                     
                    
                      
                        H
                      
                      
                        k
                      
                    
                    
                      
                        P
                      
                      
                        k
                          x     
                        k
                          x     
                         
                      
                    
                    
                      
                        H
                      
                      
                        k
                      
                      
                        
                          T
                        
                      
                    
                  
                   
                
              
            
            
              
              
                
                 
                
                    x   f 
                  
                    k
                     
                     
                  
                  
                    T
                  
                
                
                  
                    N
                  
                
                
                   
                  
                    
                      
                        z
                      
                      
                        k
                      
                    
                     
                    
                      
                        H
                      
                      
                        k
                      
                    
                    
                      
                        
                          
                            
                              x
                            
                              x e 
                          
                        
                      
                      
                        k
                          x     
                        k
                          x     
                         
                      
                    
                     
                    
                      
                        S
                      
                      
                        k
                      
                    
                  
                   
                
                 
              
            
          
        
      
    
      displaystyle   begin aligned p  mathbf  z    amp   prod   k     T  int p left  mathbf  z    k  mid  mathbf  x    k  right p left  mathbf  x    k  mid  mathbf  z    k     ldots   mathbf  z       right d mathbf  x    k    amp   prod   k     T  int   mathcal  N   left  mathbf  z    k   mathbf  H    k  mathbf  x    k   mathbf  R    k  right   mathcal  N   left  mathbf  x    k    hat   mathbf  x      k mid k     mathbf  P    k mid k    right d mathbf  x    k    amp   prod   k     T   mathcal  N   left  mathbf  z    k   mathbf  H    k   hat   mathbf  x      k mid k     mathbf  R    k   mathbf  H    k  mathbf  P    k mid k    mathbf  H    k    textsf  T   right    amp   prod   k     T   mathcal  N   left  mathbf  z    k   mathbf  H    k   hat   mathbf  x      k mid k     mathbf  S    k  right   end aligned   
  

i e   a product of Gaussian densities  each corresponding to the density of one observation zk under the current filtering distribution 
  
    
      
        
          
            H
          
          
            k
          
        
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            k
              x     
            k
              x     
             
          
        
         
        
          
            S
          
          
            k
          
        
      
    
      displaystyle  mathbf  H    k   hat   mathbf  x      k mid k     mathbf  S    k  
  
  This can easily be computed as a simple recursive update  however  to avoid numeric underflow  in a practical implementation it is usually desirable to compute the log marginal likelihood 
  
    
      
          x     
         
        log
          x     
        p
         
        
          z
        
         
      
    
      displaystyle  ell   log p  mathbf  z    
  
 instead  Adopting the convention 
  
    
      
        
            x     
          
             
              x     
             
             
          
        
         
         
      
    
      displaystyle  ell           
  
  this can be done via the recursive update rule


  
    
      
        
            x     
          
             
            k
             
          
        
         
        
            x     
          
             
            k
              x     
             
             
          
        
          x     
        
          
             
             
          
        
        
           
          
            
              
                
                  
                    
                      y
                    
                      x e 
                  
                
              
              
                k
              
              
                
                  T
                
              
            
            
              
                S
              
              
                k
              
              
                  x     
                 
              
            
            
              
                
                  
                    
                      y
                    
                      x e 
                  
                
              
              
                k
              
            
             
            log
              x     
            
               
              
                
                  S
                
                
                  k
                
              
               
            
             
            
              d
              
                y
              
            
            log
              x     
             
              x c  
          
           
        
         
      
    
      displaystyle  ell    k    ell    k       frac         left   tilde   mathbf  y      k    textsf  T   mathbf  S    k        tilde   mathbf  y      k   log  left  mathbf  S    k  right  d  y  log   pi  right   
  

where 
  
    
      
        
          d
          
            y
          
        
      
    
      displaystyle d  y  
  
 is the dimension of the measurement vector             
An important application where such a  log  likelihood of the observations  given the filter parameters  is used is multi target tracking  For example  consider an object tracking scenario where a stream of observations is the input  however  it is unknown how many objects are in the scene  or  the number of objects is known but is greater than one   For such a scenario  it can be unknown apriori which observations measurements were generated by which object  A multiple hypothesis tracker  MHT  typically will form different track association hypotheses  where each hypothesis can be considered as a Kalman filter  for the linear Gaussian case  with a specific set of parameters associated with the hypothesized object  Thus  it is important to compute the likelihood of the observations for the different hypotheses under consideration  such that the most likely one can be found 

Information filter edit 
This section needs additional citations for verification  Please help improve this article by adding citations to reliable sources     in this section  Unsourced material may be challenged and removed    April        Learn how and when to remove this message 
In cases where the dimension of the observation vector y is bigger than the dimension of the state space vector x  the information filter can avoid the inversion of a bigger matrix in the Kalman gain calculation at the price of inverting a smaller matrix in the prediction step  thus saving computing time  Additionally  the information filter allows for system information initialization according to 
  
    
      
        
          
            I
            
               
              
                 
              
               
            
          
           
          
            P
            
               
              
                 
              
               
            
            
                x     
               
            
          
           
           
        
      
    
      displaystyle  I       P               
  
  which would not be possible for the regular Kalman filter              In the information filter  or inverse covariance filter  the estimated covariance and estimated state are replaced by the information matrix and information vector respectively  These are defined as 


  
    
      
        
          
            
              
                
                  
                    Y
                  
                  
                    k
                      x     
                    k
                  
                
              
              
                
                 
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                  
                  
                      x     
                     
                  
                
              
            
            
              
                
                  
                    
                      
                        
                          y
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                    k
                  
                
              
              
                
                 
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                  
                  
                      x     
                     
                  
                
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                    k
                  
                
              
            
          
        
      
    
      displaystyle   begin aligned  mathbf  Y    k mid k  amp   mathbf  P    k mid k          hat   mathbf  y      k mid k  amp   mathbf  P    k mid k        hat   mathbf  x      k mid k  end aligned   
  

Similarly the predicted covariance and state have equivalent information forms  defined as 


  
    
      
        
          
            
              
                
                  
                    Y
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
              
              
                
                 
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                  
                      x     
                     
                  
                
              
            
            
              
                
                  
                    
                      
                        
                          y
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
              
              
                
                 
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                  
                      x     
                     
                  
                
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
              
            
          
        
      
    
      displaystyle   begin aligned  mathbf  Y    k mid k    amp   mathbf  P    k mid k            hat   mathbf  y      k mid k    amp   mathbf  P    k mid k          hat   mathbf  x      k mid k    end aligned   
  

and the measurement covariance and measurement vector  which are defined as 


  
    
      
        
          
            
              
                
                  
                    I
                  
                  
                    k
                  
                
              
              
                
                 
                
                  
                    H
                  
                  
                    k
                  
                  
                    
                      T
                    
                  
                
                
                  
                    R
                  
                  
                    k
                  
                  
                      x     
                     
                  
                
                
                  
                    H
                  
                  
                    k
                  
                
              
            
            
              
                
                  
                    i
                  
                  
                    k
                  
                
              
              
                
                 
                
                  
                    H
                  
                  
                    k
                  
                  
                    
                      T
                    
                  
                
                
                  
                    R
                  
                  
                    k
                  
                  
                      x     
                     
                  
                
                
                  
                    z
                  
                  
                    k
                  
                
              
            
          
        
      
    
      displaystyle   begin aligned  mathbf  I    k  amp   mathbf  H    k    textsf  T   mathbf  R    k       mathbf  H    k    mathbf  i    k  amp   mathbf  H    k    textsf  T   mathbf  R    k       mathbf  z    k  end aligned   
  

The information update now becomes a trivial sum             


  
    
      
        
          
            
              
                
                  
                    Y
                  
                  
                    k
                      x     
                    k
                  
                
              
              
                
                 
                
                  
                    Y
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
                 
                
                  
                    I
                  
                  
                    k
                  
                
              
            
            
              
                
                  
                    
                      
                        
                          y
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                    k
                  
                
              
              
                
                 
                
                  
                    
                      
                        
                          y
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
                 
                
                  
                    i
                  
                  
                    k
                  
                
              
            
          
        
      
    
      displaystyle   begin aligned  mathbf  Y    k mid k  amp   mathbf  Y    k mid k     mathbf  I    k     hat   mathbf  y      k mid k  amp    hat   mathbf  y      k mid k     mathbf  i    k  end aligned   
  

The main advantage of the information filter is that N measurements can be filtered at each time step simply by summing their information matrices and vectors 


  
    
      
        
          
            
              
                
                  
                    Y
                  
                  
                    k
                      x     
                    k
                  
                
              
              
                
                 
                
                  
                    Y
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
                 
                
                    x     
                  
                    j
                     
                     
                  
                  
                    N
                  
                
                
                  
                    I
                  
                  
                    k
                     
                    j
                  
                
              
            
            
              
                
                  
                    
                      
                        
                          y
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                    k
                  
                
              
              
                
                 
                
                  
                    
                      
                        
                          y
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
                 
                
                    x     
                  
                    j
                     
                     
                  
                  
                    N
                  
                
                
                  
                    i
                  
                  
                    k
                     
                    j
                  
                
              
            
          
        
      
    
      displaystyle   begin aligned  mathbf  Y    k mid k  amp   mathbf  Y    k mid k     sum   j     N  mathbf  I    k j     hat   mathbf  y      k mid k  amp    hat   mathbf  y      k mid k     sum   j     N  mathbf  i    k j  end aligned   
  

To predict the information filter the information matrix and vector can be converted back to their state space equivalents  or alternatively the information space prediction can be used             


  
    
      
        
          
            
              
                
                  
                    M
                  
                  
                    k
                  
                
              
              
                
                 
                
                  
                     
                    
                      
                        F
                      
                      
                        k
                      
                      
                          x     
                         
                      
                    
                     
                  
                  
                    
                      T
                    
                  
                
                
                  
                    Y
                  
                  
                    k
                      x     
                     
                      x     
                    k
                      x     
                     
                  
                
                
                  
                    F
                  
                  
                    k
                  
                  
                      x     
                     
                  
                
              
            
            
              
                
                  
                    C
                  
                  
                    k
                  
                
              
              
                
                 
                
                  
                    M
                  
                  
                    k
                  
                
                
                  
                     
                    
                      
                        
                          M
                        
                        
                          k
                        
                      
                       
                      
                        
                          Q
                        
                        
                          k
                        
                        
                            x     
                           
                        
                      
                    
                     
                  
                  
                      x     
                     
                  
                
              
            
            
              
                
                  
                    L
                  
                  
                    k
                  
                
              
              
                
                 
                
                  I
                
                  x     
                
                  
                    C
                  
                  
                    k
                  
                
              
            
            
              
                
                  
                    Y
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
              
              
                
                 
                
                  
                    L
                  
                  
                    k
                  
                
                
                  
                    M
                  
                  
                    k
                  
                
                 
                
                  
                    C
                  
                  
                    k
                  
                
                
                  
                    Q
                  
                  
                    k
                  
                  
                      x     
                     
                  
                
                
                  
                    C
                  
                  
                    k
                  
                  
                    
                      T
                    
                  
                
              
            
            
              
                
                  
                    
                      
                        
                          y
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
              
              
                
                 
                
                  
                    L
                  
                  
                    k
                  
                
                
                  
                     
                    
                      
                        F
                      
                      
                        k
                      
                      
                          x     
                         
                      
                    
                     
                  
                  
                    
                      T
                    
                  
                
                
                  
                    
                      
                        
                          y
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                     
                      x     
                    k
                      x     
                     
                  
                
              
            
          
        
      
    
      displaystyle   begin aligned  mathbf  M    k  amp   left  mathbf  F    k       right    textsf  T   mathbf  Y    k   mid k    mathbf  F    k         mathbf  C    k  amp   mathbf  M    k  left  mathbf  M    k   mathbf  Q    k       right         mathbf  L    k  amp   mathbf  I    mathbf  C    k    mathbf  Y    k mid k    amp   mathbf  L    k  mathbf  M    k   mathbf  C    k  mathbf  Q    k       mathbf  C    k    textsf  T      hat   mathbf  y      k mid k    amp   mathbf  L    k  left  mathbf  F    k       right    textsf  T    hat   mathbf  y      k   mid k    end aligned   
  

Fixed lag smoother edit 
This section needs additional citations for verification  Please help improve this article by adding citations to reliable sources     in this section  Unsourced material may be challenged and removed    December        Learn how and when to remove this message 
The optimal fixed lag smoother provides the optimal estimate of 
  
    
      
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            k
              x     
            N
              x     
            k
          
        
      
    
      displaystyle   hat   mathbf  x      k N mid k  
  
 for a given fixed lag 
  
    
      
        N
      
    
      displaystyle N 
  
 using the measurements from 
  
    
      
        
          
            z
          
          
             
          
        
      
    
      displaystyle  mathbf  z       
  
 to 
  
    
      
        
          
            z
          
          
            k
          
        
      
    
      displaystyle  mathbf  z    k  
  
              It can be derived using the previous theory via an augmented state  and the main equation of the filter is the following 


  
    
      
        
          
             
            
              
                
                  
                    
                      
                        
                          
                            x
                          
                            x e 
                        
                      
                    
                    
                      t
                        x     
                      t
                    
                  
                
              
              
                
                  
                    
                      
                        
                          
                            x
                          
                            x e 
                        
                      
                    
                    
                      t
                        x     
                       
                        x     
                      t
                    
                  
                
              
              
                
                    x  ee 
                
              
              
                
                  
                    
                      
                        
                          
                            x
                          
                            x e 
                        
                      
                    
                    
                      t
                        x     
                      N
                       
                       
                        x     
                      t
                    
                  
                
              
            
             
          
        
         
        
          
             
            
              
                
                  
                    I
                  
                
              
              
                
                   
                
              
              
                
                    x  ee 
                
              
              
                
                   
                
              
            
             
          
        
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            t
              x     
            t
              x     
             
          
        
         
        
          
             
            
              
                
                   
                
                
                    x     
                
                
                   
                
              
              
                
                  
                    I
                  
                
                
                   
                
                
                    x  ee 
                
              
              
                
                    x  ee 
                
                
                    x  f  
                
                
                    x  ee 
                
              
              
                
                   
                
                
                    x     
                
                
                  
                    I
                  
                
              
            
             
          
        
        
          
             
            
              
                
                  
                    
                      
                        
                          
                            x
                          
                            x e 
                        
                      
                    
                    
                      t
                        x     
                       
                        x     
                      t
                        x     
                       
                    
                  
                
              
              
                
                  
                    
                      
                        
                          
                            x
                          
                            x e 
                        
                      
                    
                    
                      t
                        x     
                       
                        x     
                      t
                        x     
                       
                    
                  
                
              
              
                
                    x  ee 
                
              
              
                
                  
                    
                      
                        
                          
                            x
                          
                            x e 
                        
                      
                    
                    
                      t
                        x     
                      N
                       
                       
                        x     
                      t
                        x     
                       
                    
                  
                
              
            
             
          
        
         
        
          
             
            
              
                
                  
                    
                      K
                    
                    
                       
                       
                       
                    
                  
                
              
              
                
                  
                    
                      K
                    
                    
                       
                       
                       
                    
                  
                
              
              
                
                    x  ee 
                
              
              
                
                  
                    
                      K
                    
                    
                       
                      N
                        x     
                       
                       
                    
                  
                
              
            
             
          
        
        
          
            y
          
          
            t
              x     
            t
              x     
             
          
        
      
    
      displaystyle   begin bmatrix   hat   mathbf  x      t mid t     hat   mathbf  x      t   mid t    vdots     hat   mathbf  x      t N   mid t    end bmatrix     begin bmatrix  mathbf  I        vdots       end bmatrix    hat   mathbf  x      t mid t      begin bmatrix   amp  ldots  amp     mathbf  I   amp   amp  vdots    vdots  amp  ddots  amp  vdots     amp  ldots  amp  mathbf  I     end bmatrix    begin bmatrix   hat   mathbf  x      t   mid t       hat   mathbf  x      t   mid t      vdots     hat   mathbf  x      t N   mid t      end bmatrix     begin bmatrix  mathbf  K           mathbf  K           vdots    mathbf  K     N       end bmatrix   mathbf  y    t mid t    
  

where 


  
    
      
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            t
              x     
            t
              x     
             
          
        
      
    
      displaystyle   hat   mathbf  x      t mid t    
  
 is estimated via a standard Kalman filter 

  
    
      
        
          
            y
          
          
            t
              x     
            t
              x     
             
          
        
         
        
          
            z
          
          
            t
          
        
          x     
        
          H
        
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            t
              x     
            t
              x     
             
          
        
      
    
      displaystyle  mathbf  y    t mid t     mathbf  z    t   mathbf  H    hat   mathbf  x      t mid t    
  
 is the innovation produced considering the estimate of the standard Kalman filter 
the various 
  
    
      
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            t
              x     
            i
              x     
            t
          
        
      
    
      displaystyle   hat   mathbf  x      t i mid t  
  
 with 
  
    
      
        i
         
         
         
          x     
         
        N
          x     
         
      
    
      displaystyle i    ldots  N   
  
 are new variables  i e   they do not appear in the standard Kalman filter 
the gains are computed via the following scheme 

  
    
      
        
          
            K
          
          
             
            i
             
             
             
          
        
         
        
          
            P
          
          
             
            i
             
          
        
        
          
            H
          
          
            
              T
            
          
        
        
          
             
            
              
                H
              
              
                P
              
              
                
                  H
                
                
                  
                    T
                  
                
              
               
              
                R
              
            
             
          
          
              x     
             
          
        
      
    
      displaystyle  mathbf  K     i      mathbf  P     i   mathbf  H     textsf  T   left  mathbf  H   mathbf  P   mathbf  H     textsf  T    mathbf  R   right       
  

and

  
    
      
        
          
            P
          
          
             
            i
             
          
        
         
        
          P
        
        
          
             
            
              
                 
                
                  
                    F
                  
                    x     
                  
                    K
                  
                  
                    H
                  
                
                 
              
              
                
                  T
                
              
            
             
          
          
            i
          
        
      
    
      displaystyle  mathbf  P     i    mathbf  P   left  left  mathbf  F    mathbf  K   mathbf  H   right    textsf  T   right   i  
  

where 
  
    
      
        
          P
        
      
    
      displaystyle  mathbf  P   
  
 and 
  
    
      
        
          K
        
      
    
      displaystyle  mathbf  K   
  
 are the prediction error covariance and the gains of the standard Kalman filter  i e   
  
    
      
        
          
            P
          
          
            t
              x     
            t
              x     
             
          
        
      
    
      displaystyle  mathbf  P    t mid t    
  
  
If the estimation error covariance is defined so that


  
    
      
        
          
            P
          
          
            i
          
        
          
        E
        
           
          
            
              
                 
                
                  
                    
                      x
                    
                    
                      t
                        x     
                      i
                    
                  
                    x     
                  
                    
                      
                        
                          
                            x
                          
                            x e 
                        
                      
                    
                    
                      t
                        x     
                      i
                        x     
                      t
                    
                  
                
                 
              
              
                  x     
              
            
            
               
              
                
                  
                    x
                  
                  
                    t
                      x     
                    i
                  
                
                  x     
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    t
                      x     
                    i
                      x     
                    t
                  
                
              
               
            
              x     
            
              z
              
                 
              
            
              x     
            
              z
              
                t
              
            
          
           
        
         
      
    
      displaystyle  mathbf  P    i   E left  left  mathbf  x    t i    hat   mathbf  x      t i mid t  right      left  mathbf  x    t i    hat   mathbf  x      t i mid t  right  mid z     ldots z  t  right   
  

then we have that the improvement on the estimation of 
  
    
      
        
          
            x
          
          
            t
              x     
            i
          
        
      
    
      displaystyle  mathbf  x    t i  
  
 is given by 


  
    
      
        
          P
        
          x     
        
          
            P
          
          
            i
          
        
         
        
            x     
          
            j
             
             
          
          
            i
          
        
        
           
          
            
              
                P
              
              
                 
                j
                 
              
            
            
              
                H
              
              
                
                  T
                
              
            
            
              
                 
                
                  
                    H
                  
                  
                    P
                  
                  
                    
                      H
                    
                    
                      
                        T
                      
                    
                  
                   
                  
                    R
                  
                
                 
              
              
                  x     
                 
              
            
            
              H
            
            
              
                 
                
                  
                    P
                  
                  
                     
                    i
                     
                  
                
                 
              
              
                
                  T
                
              
            
          
           
        
      
    
      displaystyle  mathbf  P    mathbf  P    i   sum   j     i  left  mathbf  P     j   mathbf  H     textsf  T   left  mathbf  H   mathbf  P   mathbf  H     textsf  T    mathbf  R   right       mathbf  H   left  mathbf  P     i   right    textsf  T   right  
  

Fixed interval smoothers edit 
The optimal fixed interval smoother provides the optimal estimate of 
  
    
      
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            k
              x     
            n
          
        
      
    
      displaystyle   hat   mathbf  x      k mid n  
  
  
  
    
      
        k
         lt 
        n
      
    
      displaystyle k lt n 
  
  using the measurements from a fixed interval 
  
    
      
        
          
            z
          
          
             
          
        
      
    
      displaystyle  mathbf  z       
  
 to 
  
    
      
        
          
            z
          
          
            n
          
        
      
    
      displaystyle  mathbf  z    n  
  
  This is also called  Kalman Smoothing   There are several smoothing algorithms in common use 

Rauch Tung Striebel edit 
The Rauch Tung Striebel  RTS  smoother is an efficient two pass algorithm for fixed interval smoothing             
The forward pass is the same as the regular Kalman filter algorithm  These filtered a priori and a posteriori state estimates 
  
    
      
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            k
              x     
            k
              x     
             
          
        
      
    
      displaystyle   hat   mathbf  x      k mid k    
  
  
  
    
      
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            k
              x     
            k
          
        
      
    
      displaystyle   hat   mathbf  x      k mid k  
  
 and covariances 
  
    
      
        
          
            P
          
          
            k
              x     
            k
              x     
             
          
        
      
    
      displaystyle  mathbf  P    k mid k    
  
  
  
    
      
        
          
            P
          
          
            k
              x     
            k
          
        
      
    
      displaystyle  mathbf  P    k mid k  
  
 are saved for use in the backward pass  for retrodiction  
In the backward pass  we compute the smoothed state estimates 
  
    
      
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            k
              x     
            n
          
        
      
    
      displaystyle   hat   mathbf  x      k mid n  
  
 and covariances 
  
    
      
        
          
            P
          
          
            k
              x     
            n
          
        
      
    
      displaystyle  mathbf  P    k mid n  
  
  We start at the last time step and proceed backward in time using the following recursive equations 


  
    
      
        
          
            
              
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                    n
                  
                
              
              
                
                 
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                    k
                  
                
                 
                
                  
                    C
                  
                  
                    k
                  
                
                
                   
                  
                    
                      
                        
                          
                            
                              x
                            
                              x e 
                          
                        
                      
                      
                        k
                         
                         
                          x     
                        n
                      
                    
                      x     
                    
                      
                        
                          
                            
                              x
                            
                              x e 
                          
                        
                      
                      
                        k
                         
                         
                          x     
                        k
                      
                    
                  
                   
                
              
            
            
              
                
                  
                    P
                  
                  
                    k
                      x     
                    n
                  
                
              
              
                
                 
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                  
                
                 
                
                  
                    C
                  
                  
                    k
                  
                
                
                   
                  
                    
                      
                        P
                      
                      
                        k
                         
                         
                          x     
                        n
                      
                    
                      x     
                    
                      
                        P
                      
                      
                        k
                         
                         
                          x     
                        k
                      
                    
                  
                   
                
                
                  
                    C
                  
                  
                    k
                  
                  
                    
                      T
                    
                  
                
              
            
          
        
      
    
      displaystyle   begin aligned   hat   mathbf  x      k mid n  amp    hat   mathbf  x      k mid k   mathbf  C    k  left   hat   mathbf  x      k   mid n    hat   mathbf  x      k   mid k  right    mathbf  P    k mid n  amp   mathbf  P    k mid k   mathbf  C    k  left  mathbf  P    k   mid n   mathbf  P    k   mid k  right  mathbf  C    k    textsf  T   end aligned   
  

where


  
    
      
        
          
            C
          
          
            k
          
        
         
        
          
            P
          
          
            k
              x     
            k
          
        
        
          
            F
          
          
            k
             
             
          
          
            
              T
            
          
        
        
          
            P
          
          
            k
             
             
              x     
            k
          
          
              x     
             
          
        
         
      
    
      displaystyle  mathbf  C    k   mathbf  P    k mid k  mathbf  F    k      textsf  T   mathbf  P    k   mid k        
  


  
    
      
        
          
            x
          
          
            k
              x     
            k
          
        
      
    
      displaystyle  mathbf  x    k mid k  
  
 is the a posteriori state estimate of timestep 
  
    
      
        k
      
    
      displaystyle k 
  
 and 
  
    
      
        
          
            x
          
          
            k
             
             
              x     
            k
          
        
      
    
      displaystyle  mathbf  x    k   mid k  
  
 is the a priori state estimate of timestep 
  
    
      
        k
         
         
      
    
      displaystyle k   
  
  The same notation applies to the covariance 

Modified Bryson Frazier smoother edit 
An alternative to the RTS algorithm is the modified Bryson Frazier  MBF  fixed interval smoother developed by Bierman              This also uses a backward pass that processes data saved from the Kalman filter forward pass  The equations for the backward pass involve the recursive
computation of data which are used at each observation time to compute the smoothed state and covariance 
The recursive equations are


  
    
      
        
          
            
              
                
                  
                    
                      
                          x  b 
                          x e 
                      
                    
                  
                  
                    k
                  
                
              
              
                
                 
                
                  
                    H
                  
                  
                    k
                  
                  
                    
                      T
                    
                  
                
                
                  
                    S
                  
                  
                    k
                  
                  
                      x     
                     
                  
                
                
                  
                    H
                  
                  
                    k
                  
                
                 
                
                  
                    
                      
                        
                          C
                        
                          x e 
                      
                    
                  
                  
                    k
                  
                  
                    
                      T
                    
                  
                
                
                  
                    
                      
                          x  b 
                          x e 
                      
                    
                  
                  
                    k
                  
                
                
                  
                    
                      
                        
                          C
                        
                          x e 
                      
                    
                  
                  
                    k
                  
                
              
            
            
              
                
                  
                    
                      
                          x  b 
                          x e 
                      
                    
                  
                  
                    k
                      x     
                     
                  
                
              
              
                
                 
                
                  
                    F
                  
                  
                    k
                  
                  
                    
                      T
                    
                  
                
                
                  
                    
                      
                          x  b 
                          x e 
                      
                    
                  
                  
                    k
                  
                
                
                  
                    F
                  
                  
                    k
                  
                
              
            
            
              
                
                  
                    
                      
                          x  b 
                          x e 
                      
                    
                  
                  
                    n
                  
                
              
              
                
                 
                 
              
            
            
              
                
                  
                    
                      
                          x bb 
                          x e 
                      
                    
                  
                  
                    k
                  
                
              
              
                
                 
                  x     
                
                  
                    H
                  
                  
                    k
                  
                  
                    
                      T
                    
                  
                
                
                  
                    S
                  
                  
                    k
                  
                  
                      x     
                     
                  
                
                
                  
                    y
                  
                  
                    k
                  
                
                 
                
                  
                    
                      
                        
                          C
                        
                          x e 
                      
                    
                  
                  
                    k
                  
                  
                    
                      T
                    
                  
                
                
                  
                    
                      
                          x bb 
                          x e 
                      
                    
                  
                  
                    k
                  
                
              
            
            
              
                
                  
                    
                      
                          x bb 
                          x e 
                      
                    
                  
                  
                    k
                      x     
                     
                  
                
              
              
                
                 
                
                  
                    F
                  
                  
                    k
                  
                  
                    
                      T
                    
                  
                
                
                  
                    
                      
                          x bb 
                          x e 
                      
                    
                  
                  
                    k
                  
                
              
            
            
              
                
                  
                    
                      
                          x bb 
                          x e 
                      
                    
                  
                  
                    n
                  
                
              
              
                
                 
                 
              
            
          
        
      
    
      displaystyle   begin aligned   tilde   Lambda     k  amp   mathbf  H    k    textsf  T   mathbf  S    k       mathbf  H    k    hat   mathbf  C      k    textsf  T    hat   Lambda     k   hat   mathbf  C      k     hat   Lambda     k    amp   mathbf  F    k    textsf  T    tilde   Lambda     k  mathbf  F    k     hat   Lambda     n  amp       tilde   lambda     k  amp    mathbf  H    k    textsf  T   mathbf  S    k       mathbf  y    k    hat   mathbf  C      k    textsf  T    hat   lambda     k     hat   lambda     k    amp   mathbf  F    k    textsf  T    tilde   lambda     k     hat   lambda     n  amp    end aligned   
  

where 
  
    
      
        
          
            S
          
          
            k
          
        
      
    
      displaystyle  mathbf  S    k  
  
 is the residual covariance and 
  
    
      
        
          
            
              
                
                  C
                
                  x e 
              
            
          
          
            k
          
        
         
        
          I
        
          x     
        
          
            K
          
          
            k
          
        
        
          
            H
          
          
            k
          
        
      
    
      displaystyle   hat   mathbf  C      k   mathbf  I    mathbf  K    k  mathbf  H    k  
  
  The smoothed state and covariance can then be found by substitution in the equations


  
    
      
        
          
            
              
                
                  
                    P
                  
                  
                    k
                      x     
                    n
                  
                
              
              
                
                 
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                  
                
                  x     
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                  
                
                
                  
                    
                      
                          x  b 
                          x e 
                      
                    
                  
                  
                    k
                  
                
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                  
                
              
            
            
              
                
                  
                    x
                  
                  
                    k
                      x     
                    n
                  
                
              
              
                
                 
                
                  
                    x
                  
                  
                    k
                      x     
                    k
                  
                
                  x     
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                  
                
                
                  
                    
                      
                          x bb 
                          x e 
                      
                    
                  
                  
                    k
                  
                
              
            
          
        
      
    
      displaystyle   begin aligned  mathbf  P    k mid n  amp   mathbf  P    k mid k   mathbf  P    k mid k   hat   Lambda     k  mathbf  P    k mid k    mathbf  x    k mid n  amp   mathbf  x    k mid k   mathbf  P    k mid k   hat   lambda     k  end aligned   
  

or


  
    
      
        
          
            
              
                
                  
                    P
                  
                  
                    k
                      x     
                    n
                  
                
              
              
                
                 
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
                  x     
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
                
                  
                    
                      
                          x  b 
                          x e 
                      
                    
                  
                  
                    k
                  
                
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
              
            
            
              
                
                  
                    x
                  
                  
                    k
                      x     
                    n
                  
                
              
              
                
                 
                
                  
                    x
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
                  x     
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
                
                  
                    
                      
                          x bb 
                          x e 
                      
                    
                  
                  
                    k
                  
                
                 
              
            
          
        
      
    
      displaystyle   begin aligned  mathbf  P    k mid n  amp   mathbf  P    k mid k     mathbf  P    k mid k     tilde   Lambda     k  mathbf  P    k mid k      mathbf  x    k mid n  amp   mathbf  x    k mid k     mathbf  P    k mid k     tilde   lambda     k   end aligned   
  

An important advantage of the MBF is that it does not require finding the inverse of the covariance matrix   Bierman s derivation is based on the RTS smoother  which assumes that the underlying distributions are Gaussian  However  a derivation of the MBF based on the concept of the fixed point smoother  which does not require the Gaussian assumption  is given by Gibbs             
The MBF can also be used to perform consistency checks on the filter residuals and the difference between the value of a filter state after an update and the smoothed value of the state  that is 
  
    
      
        
          
            x
          
          
            k
              x     
            k
          
        
          x     
        
          
            x
          
          
            k
              x     
            n
          
        
      
    
      displaystyle  mathbf  x    k mid k   mathbf  x    k mid n  
  
             

Minimum variance smoother edit 
The minimum variance smoother can attain the best possible error performance  provided that the models are linear  their parameters and the noise statistics are known precisely              This smoother is a time varying state space generalization of the optimal non causal Wiener filter 
The smoother calculations are done in two passes  The forward calculations involve a one step ahead predictor and are given by


  
    
      
        
          
            
              
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    k
                     
                     
                      x     
                    k
                  
                
              
              
                
                 
                 
                
                  
                    F
                  
                  
                    k
                  
                
                  x     
                
                  
                    K
                  
                  
                    k
                  
                
                
                  
                    H
                  
                  
                    k
                  
                
                 
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
                 
                
                  
                    K
                  
                  
                    k
                  
                
                
                  
                    z
                  
                  
                    k
                  
                
              
            
            
              
                
                    x b  
                  
                    k
                  
                
              
              
                
                 
                  x     
                
                  
                    S
                  
                  
                    k
                  
                  
                      x     
                    
                      
                         
                         
                      
                    
                  
                
                
                  
                    H
                  
                  
                    k
                  
                
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
                 
                
                  
                    S
                  
                  
                    k
                  
                  
                      x     
                    
                      
                         
                         
                      
                    
                  
                
                
                  
                    z
                  
                  
                    k
                  
                
              
            
          
        
      
    
      displaystyle   begin aligned   hat   mathbf  x      k   mid k  amp    mathbf  F    k   mathbf  K    k  mathbf  H    k    hat   mathbf  x      k mid k     mathbf  K    k  mathbf  z    k    alpha   k  amp    mathbf  S    k      frac          mathbf  H    k   hat   mathbf  x      k mid k     mathbf  S    k      frac          mathbf  z    k  end aligned   
  

The above system is known as the inverse Wiener Hopf factor  The backward recursion is the adjoint of the above forward system  The result of the backward pass 
  
    
      
        
            x b  
          
            k
          
        
      
    
      displaystyle  beta   k  
  
  may be calculated by operating the forward equations on the time reversed 
  
    
      
        
            x b  
          
            k
          
        
      
    
      displaystyle  alpha   k  
  
  and time reversing the result  In the case of output estimation  the smoothed estimate is given by


  
    
      
        
          
            
              
                
                  y
                
                  x e 
              
            
          
          
            k
              x     
            N
          
        
         
        
          
            z
          
          
            k
          
        
          x     
        
          
            R
          
          
            k
          
        
        
            x b  
          
            k
          
        
      
    
      displaystyle   hat   mathbf  y      k mid N   mathbf  z    k   mathbf  R    k  beta   k  
  

Taking the causal part of this minimum variance smoother yields


  
    
      
        
          
            
              
                
                  y
                
                  x e 
              
            
          
          
            k
              x     
            k
          
        
         
        
          
            z
          
          
            k
          
        
          x     
        
          
            R
          
          
            k
          
        
        
          
            S
          
          
            k
          
          
              x     
            
              
                 
                 
              
            
          
        
        
            x b  
          
            k
          
        
      
    
      displaystyle   hat   mathbf  y      k mid k   mathbf  z    k   mathbf  R    k  mathbf  S    k      frac          alpha   k  
  

which is identical to the minimum variance Kalman filter  The above solutions minimize the variance of the output estimation error  Note that the Rauch Tung Striebel smoother derivation assumes that the underlying distributions are Gaussian  whereas the minimum variance solutions do not  Optimal smoothers for state estimation and input estimation can be constructed similarly 
A continuous time version of the above smoother is described in                         
Expectation maximization algorithms may be employed to calculate approximate maximum likelihood estimates of unknown state space parameters within minimum variance filters and smoothers  Often uncertainties remain within problem assumptions  A smoother that accommodates uncertainties can be designed by adding a positive definite term to the Riccati equation             
In cases where the models are nonlinear  step wise linearizations may be within the minimum variance filter and smoother recursions  extended Kalman filtering  

Frequency weighted Kalman filters edit 
Pioneering research on the perception of sounds at different frequencies was conducted by Fletcher and Munson in the     s  Their work led to a standard way of weighting measured sound levels within investigations of industrial noise and hearing loss  Frequency weightings have since been used within filter and controller designs to manage performance within bands of interest 
Typically  a frequency shaping function is used to weight the average power of the error spectral density in a specified frequency band  Let 
  
    
      
        
          y
        
          x     
        
          
            
              
                y
              
                x e 
            
          
        
      
    
      displaystyle  mathbf  y     hat   mathbf  y     
  
 denote the output estimation error exhibited by a conventional Kalman filter  Also  let 
  
    
      
        
          W
        
      
    
      displaystyle  mathbf  W   
  
 denote a causal frequency weighting transfer function  The optimum solution which minimizes the variance of 
  
    
      
        
          W
        
        
           
          
            
              y
            
              x     
            
              
                
                  
                    y
                  
                    x e 
                
              
            
          
           
        
      
    
      displaystyle  mathbf  W   left  mathbf  y     hat   mathbf  y     right  
  
 arises by simply constructing 
  
    
      
        
          
            W
          
          
              x     
             
          
        
        
          
            
              
                y
              
                x e 
            
          
        
      
    
      displaystyle  mathbf  W         hat   mathbf  y     
  
 
The design of 
  
    
      
        
          W
        
      
    
      displaystyle  mathbf  W   
  
 remains an open question  One way of proceeding is to identify a system which generates the estimation error and setting 
  
    
      
        
          W
        
      
    
      displaystyle  mathbf  W   
  
 equal to the inverse of that system              This procedure may be iterated to obtain mean square error improvement at the cost of increased filter order  The same technique can be applied to smoothers 

Nonlinear filters edit 
The basic Kalman filter is limited to a linear assumption  More complex systems  however  can be nonlinear  The nonlinearity can be associated either with the process model or with the observation model or with both 
The most common variants of Kalman filters for non linear systems are the Extended Kalman Filter and Unscented Kalman filter  The suitability of which filter to use depends on the non linearity indices of the process and observation model             

Extended Kalman filter edit 
Main article  Extended Kalman filter
In the extended Kalman filter  EKF   the state transition and observation models need not be linear functions of the state but may instead be nonlinear functions  These functions are of differentiable type 


  
    
      
        
          
            
              
                
                  
                    x
                  
                  
                    k
                  
                
              
              
                
                 
                f
                 
                
                  
                    x
                  
                  
                    k
                      x     
                     
                  
                
                 
                
                  
                    u
                  
                  
                    k
                  
                
                 
                 
                
                  
                    w
                  
                  
                    k
                  
                
              
            
            
              
                
                  
                    z
                  
                  
                    k
                  
                
              
              
                
                 
                h
                 
                
                  
                    x
                  
                  
                    k
                  
                
                 
                 
                
                  
                    v
                  
                  
                    k
                  
                
              
            
          
        
      
    
      displaystyle   begin aligned  mathbf  x    k  amp  f  mathbf  x    k     mathbf  u    k    mathbf  w    k    mathbf  z    k  amp  h  mathbf  x    k    mathbf  v    k  end aligned   
  

The function f can be used to compute the predicted state from the previous estimate and similarly the function h can be used to compute the predicted measurement from the predicted state  However  f and h cannot be applied to the covariance directly  Instead a matrix of partial derivatives  the Jacobian  is computed 
At each timestep the Jacobian is evaluated with current predicted states  These matrices can be used in the Kalman filter equations  This process essentially linearizes the nonlinear function around the current estimate 

Unscented Kalman filter edit 
When the state transition and observation models that is  the predict and update functions 
  
    
      
        f
      
    
      displaystyle f 
  
 and 
  
    
      
        h
      
    
      displaystyle h 
  
 are highly nonlinear  the extended Kalman filter can give particularly poor performance             
             This is because the covariance is propagated through linearization of the underlying nonlinear model  The unscented Kalman filter  UKF                    uses a deterministic sampling technique known as the unscented transformation  UT  to pick a minimal set of sample points  called sigma points  around the mean  The sigma points are then propagated through the nonlinear functions  from which a new mean and covariance estimate are then formed  The resulting filter depends on how the transformed statistics of the UT are calculated and which set of sigma points are used  It should be remarked that it is always possible to construct new UKFs in a consistent way               For certain systems  the resulting UKF more accurately estimates the true mean and covariance               This can be verified with Monte Carlo sampling or Taylor series expansion of the posterior statistics   In addition  this technique removes the requirement to explicitly calculate Jacobians  which for complex functions can be a difficult task in itself  i e   requiring complicated derivatives if done analytically or being computationally costly if done numerically   if not impossible  if those functions are not differentiable  

Sigma points edit 
For a random vector 
  
    
      
        
          x
        
         
         
        
          x
          
             
          
        
         
          x     
         
        
          x
          
            L
          
        
         
      
    
      displaystyle  mathbf  x    x      dots  x  L   
  
  sigma points are any set of vectors


  
    
      
         
        
          
            s
          
          
             
          
        
         
          x     
         
        
          
            s
          
          
            N
          
        
         
         
        
          
             
          
        
        
          
             
            
              
                
                  
                    s
                    
                       
                       
                       
                    
                  
                
                
                  
                    s
                    
                       
                       
                       
                    
                  
                
                
                    x     
                
                
                  
                    s
                    
                       
                       
                      L
                    
                  
                
              
            
             
          
        
         
          x     
         
        
          
             
            
              
                
                  
                    s
                    
                      N
                       
                       
                    
                  
                
                
                  
                    s
                    
                      N
                       
                       
                    
                  
                
                
                    x     
                
                
                  
                    s
                    
                      N
                       
                      L
                    
                  
                
              
            
             
          
        
        
          
             
          
        
      
    
      displaystyle    mathbf  s        dots   mathbf  s    N      bigl      begin pmatrix s       amp s       amp  ldots  amp s    L  end pmatrix    dots    begin pmatrix s  N    amp s  N    amp  ldots  amp s  N L  end pmatrix    bigr     
  

attributed with

first order weights 
  
    
      
        
          W
          
             
          
          
            a
          
        
         
          x     
         
        
          W
          
            N
          
          
            a
          
        
      
    
      displaystyle W      a   dots  W  N   a  
  
 that fulfill

  
    
      
        
            x     
          
            j
             
             
          
          
            N
          
        
        
          W
          
            j
          
          
            a
          
        
         
         
      
    
      displaystyle  sum   j     N W  j   a    
  

for all 
  
    
      
        i
         
         
         
          x     
         
        L
      
    
      displaystyle i    dots  L 
  
  
  
    
      
        E
         
        
          x
          
            i
          
        
         
         
        
            x     
          
            j
             
             
          
          
            N
          
        
        
          W
          
            j
          
          
            a
          
        
        
          s
          
            j
             
            i
          
        
      
    
      displaystyle E x  i    sum   j     N W  j   a s  j i  
  

second order weights 
  
    
      
        
          W
          
             
          
          
            c
          
        
         
          x     
         
        
          W
          
            N
          
          
            c
          
        
      
    
      displaystyle W      c   dots  W  N   c  
  
 that fulfill

  
    
      
        
            x     
          
            j
             
             
          
          
            N
          
        
        
          W
          
            j
          
          
            c
          
        
         
         
      
    
      displaystyle  sum   j     N W  j   c    
  

for all pairs 
  
    
      
         
        i
         
        l
         
          x     
         
         
         
          x     
         
        L
        
           
          
             
          
        
         
        E
         
        
          x
          
            i
          
        
        
          x
          
            l
          
        
         
         
        
            x     
          
            j
             
             
          
          
            N
          
        
        
          W
          
            j
          
          
            c
          
        
        
          s
          
            j
             
            i
          
        
        
          s
          
            j
             
            l
          
        
      
    
      displaystyle  i l  in      dots  L       E x  i x  l    sum   j     N W  j   c s  j i s  j l  
  
 
A simple choice of sigma points and weights for 
  
    
      
        
          
            x
          
          
            k
              x     
             
              x     
            k
              x     
             
          
        
      
    
      displaystyle  mathbf  x    k   mid k    
  
 in the UKF algorithm is


  
    
      
        
          
            
              
                
                  
                    s
                  
                  
                     
                  
                
              
              
                
                 
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                     
                      x     
                    k
                      x     
                     
                  
                
              
            
            
              
                  x     
                 
              
              
                
                 lt 
                
                  W
                  
                     
                  
                  
                    a
                  
                
                 
                
                  W
                  
                     
                  
                  
                    c
                  
                
                 lt 
                 
              
            
            
              
                
                  
                    s
                  
                  
                    j
                  
                
              
              
                
                 
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                     
                      x     
                    k
                      x     
                     
                  
                
                 
                
                  
                    
                      L
                      
                         
                          x     
                        
                          W
                          
                             
                          
                        
                      
                    
                  
                
                
                  
                    A
                  
                  
                    j
                  
                
                 
                
                j
                 
                 
                 
                  x     
                 
                L
              
            
            
              
                
                  
                    s
                  
                  
                    L
                     
                    j
                  
                
              
              
                
                 
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                     
                      x     
                    k
                      x     
                     
                  
                
                  x     
                
                  
                    
                      L
                      
                         
                          x     
                        
                          W
                          
                             
                          
                        
                      
                    
                  
                
                
                  
                    A
                  
                  
                    j
                  
                
                 
                
                j
                 
                 
                 
                  x     
                 
                L
              
            
            
              
                
                  W
                  
                    j
                  
                  
                    a
                  
                
              
              
                
                 
                
                  W
                  
                    j
                  
                  
                    c
                  
                
                 
                
                  
                    
                       
                        x     
                      
                        W
                        
                           
                        
                      
                    
                    
                       
                      L
                    
                  
                
                 
                
                j
                 
                 
                 
                  x     
                 
                 
                L
              
            
          
        
      
    
      displaystyle   begin aligned  mathbf  s       amp    hat   mathbf  x      k   mid k        amp  lt W      a  W      c  lt     mathbf  s    j  amp    hat   mathbf  x      k   mid k      sqrt   frac  L    W        mathbf  A    j   quad j    dots  L   mathbf  s    L j  amp    hat   mathbf  x      k   mid k      sqrt   frac  L    W        mathbf  A    j   quad j    dots  L  W  j   a  amp  W  j   c    frac    W       L    quad j    dots   L end aligned   
  

where 
  
    
      
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            k
              x     
             
              x     
            k
              x     
             
          
        
      
    
      displaystyle   hat   mathbf  x      k   mid k    
  
 is the mean estimate of 
  
    
      
        
          
            x
          
          
            k
              x     
             
              x     
            k
              x     
             
          
        
      
    
      displaystyle  mathbf  x    k   mid k    
  
  The vector 
  
    
      
        
          
            A
          
          
            j
          
        
      
    
      displaystyle  mathbf  A    j  
  
 is the jth column of 
  
    
      
        
          A
        
      
    
      displaystyle  mathbf  A   
  
 where 
  
    
      
        
          
            P
          
          
            k
              x     
             
              x     
            k
              x     
             
          
        
         
        
          
            A
            A
          
          
            
              T
            
          
        
      
    
      displaystyle  mathbf  P    k   mid k     mathbf  AA     textsf  T   
  
  Typically  
  
    
      
        
          A
        
      
    
      displaystyle  mathbf  A   
  
 is obtained via Cholesky decomposition of 
  
    
      
        
          
            P
          
          
            k
              x     
             
              x     
            k
              x     
             
          
        
      
    
      displaystyle  mathbf  P    k   mid k    
  
  With some care the filter equations can be expressed in such a way that 
  
    
      
        
          A
        
      
    
      displaystyle  mathbf  A   
  
 is evaluated directly without intermediate calculations of 
  
    
      
        
          
            P
          
          
            k
              x     
             
              x     
            k
              x     
             
          
        
      
    
      displaystyle  mathbf  P    k   mid k    
  
   This is referred to as the square root unscented Kalman filter             
The weight of the mean value  
  
    
      
        
          W
          
             
          
        
      
    
      displaystyle W     
  
  can be chosen arbitrarily 
Another popular parameterization  which generalizes the above  is 


  
    
      
        
          
            
              
                
                  
                    s
                  
                  
                     
                  
                
              
              
                
                 
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                     
                      x     
                    k
                      x     
                     
                  
                
              
            
            
              
                
                  W
                  
                     
                  
                  
                    a
                  
                
              
              
                
                 
                
                  
                    
                      
                          x b  
                        
                           
                        
                      
                        x ba 
                        x     
                      L
                    
                    
                      
                          x b  
                        
                           
                        
                      
                        x ba 
                    
                  
                
              
            
            
              
                
                  W
                  
                     
                  
                  
                    c
                  
                
              
              
                
                 
                
                  W
                  
                     
                  
                  
                    a
                  
                
                 
                 
                  x     
                
                    x b  
                  
                     
                  
                
                 
                  x b  
              
            
            
              
                
                  
                    s
                  
                  
                    j
                  
                
              
              
                
                 
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                     
                      x     
                    k
                      x     
                     
                  
                
                 
                  x b  
                
                  
                      x ba 
                  
                
                
                  
                    A
                  
                  
                    j
                  
                
                 
                
                j
                 
                 
                 
                  x     
                 
                L
              
            
            
              
                
                  
                    s
                  
                  
                    L
                     
                    j
                  
                
              
              
                
                 
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                     
                      x     
                    k
                      x     
                     
                  
                
                  x     
                  x b  
                
                  
                      x ba 
                  
                
                
                  
                    A
                  
                  
                    j
                  
                
                 
                
                j
                 
                 
                 
                  x     
                 
                L
              
            
            
              
                
                  W
                  
                    j
                  
                  
                    a
                  
                
              
              
                
                 
                
                  W
                  
                    j
                  
                  
                    c
                  
                
                 
                
                  
                     
                    
                       
                      
                          x b  
                        
                           
                        
                      
                        x ba 
                    
                  
                
                 
                
                j
                 
                 
                 
                  x     
                 
                 
                L
                 
              
            
          
        
      
    
      displaystyle   begin aligned  mathbf  s       amp    hat   mathbf  x      k   mid k     W      a  amp    frac   alpha      kappa  L   alpha      kappa     W      c  amp  W      a     alpha       beta    mathbf  s    j  amp    hat   mathbf  x      k   mid k     alpha   sqrt   kappa    mathbf  A    j   quad j    dots  L   mathbf  s    L j  amp    hat   mathbf  x      k   mid k     alpha   sqrt   kappa    mathbf  A    j   quad j    dots  L  W  j   a  amp  W  j   c    frac       alpha      kappa     quad j    dots   L  end aligned   
  


  
    
      
          x b  
      
    
      displaystyle  alpha  
  
 and 
  
    
      
          x ba 
      
    
      displaystyle  kappa  
  
 control the spread of the sigma points   
  
    
      
          x b  
      
    
      displaystyle  beta  
  
 is related to the distribution of 
  
    
      
        x
      
    
      displaystyle x 
  
  Note that this is an overparameterization in the sense that any one of 
  
    
      
          x b  
      
    
      displaystyle  alpha  
  
  
  
    
      
          x b  
      
    
      displaystyle  beta  
  
 and 
  
    
      
          x ba 
      
    
      displaystyle  kappa  
  
 can be chosen arbitrarily 
Appropriate values depend on the problem at hand  but a typical recommendation is 
  
    
      
          x b  
         
         
      
    
      displaystyle  alpha    
  
  
  
    
      
          x b  
         
         
      
    
      displaystyle  beta    
  
  and 
  
    
      
          x ba 
          x     
         
        L
        
           
        
         
      
    
      displaystyle  kappa  approx  L   
  
      citation needed      If the true distribution of 
  
    
      
        x
      
    
      displaystyle x 
  
 is Gaussian  
  
    
      
          x b  
         
         
      
    
      displaystyle  beta    
  
 is optimal             

Predict edit 
As with the EKF  the UKF prediction can be used independently from the UKF update  in combination with a linear  or indeed EKF  update  or vice versa 
Given estimates of the mean and covariance  
  
    
      
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            k
              x     
             
              x     
            k
              x     
             
          
        
      
    
      displaystyle   hat   mathbf  x      k   mid k    
  
 and 
  
    
      
        
          
            P
          
          
            k
              x     
             
              x     
            k
              x     
             
          
        
      
    
      displaystyle  mathbf  P    k   mid k    
  
  one obtains 
  
    
      
        N
         
         
        L
         
         
      
    
      displaystyle N  L   
  
 sigma points as described in the section above  The sigma points are propagated through the transition function f 


  
    
      
        
          
            x
          
          
            j
          
        
         
        f
        
           
          
            
              s
            
            
              j
            
          
           
        
        
        j
         
         
         
          x     
         
         
        L
      
    
      displaystyle  mathbf  x    j  f left  mathbf  s    j  right  quad j    dots   L 
  
 
The propagated sigma points are weighed to produce the predicted mean and covariance  


  
    
      
        
          
            
              
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
              
              
                
                 
                
                    x     
                  
                    j
                     
                     
                  
                  
                     
                    L
                  
                
                
                  W
                  
                    j
                  
                  
                    a
                  
                
                
                  
                    x
                  
                  
                    j
                  
                
              
            
            
              
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
              
              
                
                 
                
                    x     
                  
                    j
                     
                     
                  
                  
                     
                    L
                  
                
                
                  W
                  
                    j
                  
                  
                    c
                  
                
                
                   
                  
                    
                      
                        x
                      
                      
                        j
                      
                    
                      x     
                    
                      
                        
                          
                            
                              x
                            
                              x e 
                          
                        
                      
                      
                        k
                          x     
                        k
                          x     
                         
                      
                    
                  
                   
                
                
                  
                     
                    
                      
                        
                          x
                        
                        
                          j
                        
                      
                        x     
                      
                        
                          
                            
                              
                                x
                              
                                x e 
                            
                          
                        
                        
                          k
                            x     
                          k
                            x     
                           
                        
                      
                    
                     
                  
                  
                    
                      T
                    
                  
                
                 
                
                  
                    Q
                  
                  
                    k
                  
                
              
            
          
        
      
    
      displaystyle   begin aligned   hat   mathbf  x      k mid k    amp   sum   j      L W  j   a  mathbf  x    j    mathbf  P    k mid k    amp   sum   j      L W  j   c  left  mathbf  x    j    hat   mathbf  x      k mid k    right  left  mathbf  x    j    hat   mathbf  x      k mid k    right    textsf  T    mathbf  Q    k  end aligned   
  

where 
  
    
      
        
          W
          
            j
          
          
            a
          
        
      
    
      displaystyle W  j   a  
  
 are the first order weights of the original sigma points  and 
  
    
      
        
          W
          
            j
          
          
            c
          
        
      
    
      displaystyle W  j   c  
  
 are the second order weights  The matrix 
  
    
      
        
          
            Q
          
          
            k
          
        
      
    
      displaystyle  mathbf  Q    k  
  
 is the covariance of the transition noise  
  
    
      
        
          
            w
          
          
            k
          
        
      
    
      displaystyle  mathbf  w    k  
  
 

Update edit 
Given prediction estimates 
  
    
      
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            k
              x     
            k
              x     
             
          
        
      
    
      displaystyle   hat   mathbf  x      k mid k    
  
 and 
  
    
      
        
          
            P
          
          
            k
              x     
            k
              x     
             
          
        
      
    
      displaystyle  mathbf  P    k mid k    
  
  a new set of 
  
    
      
        N
         
         
        L
         
         
      
    
      displaystyle N  L   
  
 sigma points 
  
    
      
        
          
            s
          
          
             
          
        
         
          x     
         
        
          
            s
          
          
             
            L
          
        
      
    
      displaystyle  mathbf  s        dots   mathbf  s     L  
  
 with corresponding first order weights 
  
    
      
        
          W
          
             
          
          
            a
          
        
         
          x     
        
          W
          
             
            L
          
          
            a
          
        
      
    
      displaystyle W      a   dots W   L   a  
  
 and second order weights 
  
    
      
        
          W
          
             
          
          
            c
          
        
         
          x     
         
        
          W
          
             
            L
          
          
            c
          
        
      
    
      displaystyle W      c   dots  W   L   c  
  
 is calculated              These sigma points are transformed through the measurement function 
  
    
      
        h
      
    
      displaystyle h 
  
 


  
    
      
        
          
            z
          
          
            j
          
        
         
        h
         
        
          
            s
          
          
            j
          
        
         
         
        
        
        j
         
         
         
         
         
          x     
         
         
        L
      
    
      displaystyle  mathbf  z    j  h  mathbf  s    j       j      dots   L 
  
 
Then the empirical mean and covariance of the transformed points are calculated 


  
    
      
        
          
            
              
                
                  
                    
                      
                        z
                      
                        x e 
                    
                  
                
              
              
                
                 
                
                    x     
                  
                    j
                     
                     
                  
                  
                     
                    L
                  
                
                
                  W
                  
                    j
                  
                  
                    a
                  
                
                
                  
                    z
                  
                  
                    j
                  
                
              
            
            
              
                
                  
                    
                      
                        
                          S
                        
                          x e 
                      
                    
                  
                  
                    k
                  
                
              
              
                
                 
                
                    x     
                  
                    j
                     
                     
                  
                  
                     
                    L
                  
                
                
                  W
                  
                    j
                  
                  
                    c
                  
                
                 
                
                  
                    z
                  
                  
                    j
                  
                
                  x     
                
                  
                    
                      
                        z
                      
                        x e 
                    
                  
                
                 
                 
                
                  
                    z
                  
                  
                    j
                  
                
                  x     
                
                  
                    
                      
                        z
                      
                        x e 
                    
                  
                
                
                   
                  
                    
                      T
                    
                  
                
                 
                
                  
                    R
                    
                      k
                    
                  
                
              
            
          
        
      
    
      displaystyle   begin aligned   hat   mathbf  z     amp   sum   j      L W  j   a  mathbf  z    j     pt   hat   mathbf  S      k  amp   sum   j      L W  j   c   mathbf  z    j    hat   mathbf  z       mathbf  z    j    hat   mathbf  z        textsf  T    mathbf  R  k    end aligned   
  

where 
  
    
      
        
          
            R
          
          
            k
          
        
      
    
      displaystyle  mathbf  R    k  
  
 is the covariance matrix of the observation noise  
  
    
      
        
          
            v
          
          
            k
          
        
      
    
      displaystyle  mathbf  v    k  
  
  Additionally  the cross covariance matrix is also needed


  
    
      
        
          
            
              
                
                  
                    C
                    
                      x
                      z
                    
                  
                
              
              
                
                 
                
                    x     
                  
                    j
                     
                     
                  
                  
                     
                    L
                  
                
                
                  W
                  
                    j
                  
                  
                    c
                  
                
                 
                
                  
                    x
                  
                  
                    j
                  
                
                  x     
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    k
                    
                       
                    
                    k
                      x     
                     
                  
                
                 
                 
                
                  
                    z
                  
                  
                    j
                  
                
                  x     
                
                  
                    
                      
                        z
                      
                        x e 
                    
                  
                
                
                   
                  
                    
                      T
                    
                  
                
                 
              
            
          
        
      
    
      displaystyle   begin aligned  mathbf  C  xz    amp   sum   j      L W  j   c   mathbf  x    j    hat   mathbf  x      k k      mathbf  z    j    hat   mathbf  z        textsf  T    end aligned   
  

The Kalman gain is


  
    
      
        
          
            
              
                
                  
                    K
                  
                  
                    k
                  
                
                 
                
                  
                    C
                    
                      x
                      z
                    
                  
                
                
                  
                    
                      
                        
                          S
                        
                          x e 
                      
                    
                  
                  
                    k
                  
                  
                      x     
                     
                  
                
                 
              
            
          
        
      
    
      displaystyle   begin aligned  mathbf  K    k   mathbf  C  xz     hat   mathbf  S      k        end aligned   
  

The updated mean and covariance estimates are


  
    
      
        
          
            
              
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                    k
                  
                
              
              
                
                 
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    k
                    
                       
                    
                    k
                      x     
                     
                  
                
                 
                
                  
                    K
                  
                  
                    k
                  
                
                 
                
                  
                    z
                  
                  
                    k
                  
                
                  x     
                
                  
                    
                      
                        z
                      
                        x e 
                    
                  
                
                 
              
            
            
              
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                  
                
              
              
                
                 
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
                  x     
                
                  
                    K
                  
                  
                    k
                  
                
                
                  
                    
                      
                        
                          S
                        
                          x e 
                      
                    
                  
                  
                    k
                  
                
                
                  
                    K
                  
                  
                    k
                  
                  
                    
                      T
                    
                  
                
                 
              
            
          
        
      
    
      displaystyle   begin aligned   hat   mathbf  x      k mid k  amp    hat   mathbf  x      k k     mathbf  K    k   mathbf  z    k    hat   mathbf  z        mathbf  P    k mid k  amp   mathbf  P    k mid k     mathbf  K    k   hat   mathbf  S      k  mathbf  K    k    textsf  T    end aligned   
  

Discriminative Kalman filter edit 
When the observation model 
  
    
      
        p
         
        
          
            z
          
          
            k
          
        
          x     
        
          
            x
          
          
            k
          
        
         
      
    
      displaystyle p  mathbf  z    k  mid  mathbf  x    k   
  
 is highly non linear and or non Gaussian  it may prove advantageous to apply Bayes  rule and estimate


  
    
      
        p
         
        
          
            z
          
          
            k
          
        
          x     
        
          
            x
          
          
            k
          
        
         
          x     
        
          
            
              p
               
              
                
                  x
                
                
                  k
                
              
                x     
              
                
                  z
                
                
                  k
                
              
               
            
            
              p
               
              
                
                  x
                
                
                  k
                
              
               
            
          
        
      
    
      displaystyle p  mathbf  z    k  mid  mathbf  x    k   approx   frac  p  mathbf  x    k  mid  mathbf  z    k    p  mathbf  x    k     
  

where 
  
    
      
        p
         
        
          
            x
          
          
            k
          
        
          x     
        
          
            z
          
          
            k
          
        
         
          x     
        
          
            N
          
        
         
        g
         
        
          
            z
          
          
            k
          
        
         
         
        Q
         
        
          
            z
          
          
            k
          
        
         
         
      
    
      displaystyle p  mathbf  x    k  mid  mathbf  z    k   approx   mathcal  N   g  mathbf  z    k   Q  mathbf  z    k    
  
 for nonlinear functions 
  
    
      
        g
         
        Q
      
    
      displaystyle g Q 
  
  This replaces the generative specification of the standard Kalman filter with a discriminative model for the latent states given observations 
Under a stationary state model


  
    
      
        
          
            
              
                p
                 
                
                  
                    x
                  
                  
                     
                  
                
                 
              
              
                
                 
                
                  
                    N
                  
                
                 
                 
                 
                
                  T
                
                 
                 
              
            
            
              
                p
                 
                
                  
                    x
                  
                  
                    k
                  
                
                  x     
                
                  
                    x
                  
                  
                    k
                      x     
                     
                  
                
                 
              
              
                
                 
                
                  
                    N
                  
                
                 
                
                  F
                
                
                  
                    x
                  
                  
                    k
                      x     
                     
                  
                
                 
                
                  C
                
                 
                 
              
            
          
        
      
    
      displaystyle   begin aligned p  mathbf  x        amp    mathcal  N      mathbf  T      p  mathbf  x    k  mid  mathbf  x    k     amp    mathcal  N    mathbf  F   mathbf  x    k     mathbf  C     end aligned   
  

where 
  
    
      
        
          T
        
         
        
          F
        
        
          T
        
        
          
            F
          
          
              x  ba 
          
        
         
        
          C
        
      
    
      displaystyle  mathbf  T    mathbf  F   mathbf  T   mathbf  F     intercal    mathbf  C   
  
  if 


  
    
      
        p
         
        
          
            x
          
          
            k
          
        
          x     
        
          
            z
          
          
             
             
            k
          
        
         
          x     
        
          
            N
          
        
         
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            k
            
               
            
            k
              x     
             
          
        
         
        
          
            P
          
          
            k
            
               
            
            k
              x     
             
          
        
         
         
      
    
      displaystyle p  mathbf  x    k  mid  mathbf  z      k   approx   mathcal  N     hat   mathbf  x      k k     mathbf  P    k k      
  

then given a new observation 
  
    
      
        
          
            z
          
          
            k
          
        
      
    
      displaystyle  mathbf  z    k  
  
  it follows that            


  
    
      
        p
         
        
          
            x
          
          
            k
             
             
          
        
          x     
        
          
            z
          
          
             
             
            k
             
             
          
        
         
          x     
        
          
            N
          
        
         
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
            k
             
             
            
               
            
            k
          
        
         
        
          
            P
          
          
            k
             
             
            
               
            
            k
          
        
         
      
    
      displaystyle p  mathbf  x    k    mid  mathbf  z      k     approx   mathcal  N     hat   mathbf  x      k   k   mathbf  P    k   k   
  

where


  
    
      
        
          
            
              
                
                  
                    M
                  
                  
                    k
                     
                     
                  
                
              
              
                
                 
                
                  F
                
                
                  
                    P
                  
                  
                    k
                    
                       
                    
                    k
                      x     
                     
                  
                
                
                  
                    F
                  
                  
                      x  ba 
                  
                
                 
                
                  C
                
                 
              
            
            
              
                
                  
                    P
                  
                  
                    k
                     
                     
                    
                       
                    
                    k
                  
                
              
              
                
                 
                 
                
                  
                    M
                  
                  
                    k
                     
                     
                  
                  
                      x     
                     
                  
                
                 
                Q
                 
                
                  
                    z
                  
                  
                    k
                  
                
                
                   
                  
                      x     
                     
                  
                
                  x     
                
                  
                    T
                  
                  
                      x     
                     
                  
                
                
                   
                  
                      x     
                     
                  
                
                 
              
            
            
              
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    k
                     
                     
                    
                       
                    
                    k
                  
                
              
              
                
                 
                
                  
                    P
                  
                  
                    k
                     
                     
                    
                       
                    
                    k
                  
                
                 
                
                  
                    M
                  
                  
                    k
                     
                     
                  
                  
                      x     
                     
                  
                
                
                  F
                
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    k
                    
                       
                    
                    k
                      x     
                     
                  
                
                 
                
                  
                    P
                  
                  
                    k
                     
                     
                    
                       
                    
                    k
                  
                  
                      x     
                     
                  
                
                g
                 
                
                  
                    z
                  
                  
                    k
                  
                
                 
                 
                 
              
            
          
        
      
    
      displaystyle   begin aligned  mathbf  M    k    amp   mathbf  F   mathbf  P    k k    mathbf  F     intercal    mathbf  C      mathbf  P    k   k  amp    mathbf  M    k         Q  mathbf  z    k         mathbf  T                  hat   mathbf  x      k   k  amp   mathbf  P    k   k   mathbf  M    k         mathbf  F    hat   mathbf  x      k k     mathbf  P    k   k      g  mathbf  z    k     end aligned   
  

Note that this approximation requires 
  
    
      
        Q
         
        
          
            z
          
          
            k
          
        
        
           
          
              x     
             
          
        
          x     
        
          
            T
          
          
              x     
             
          
        
      
    
      displaystyle Q  mathbf  z    k         mathbf  T        
  
 to be positive definite  in the case that it is not  


  
    
      
        
          
            P
          
          
            k
             
             
            
               
            
            k
          
        
         
         
        
          
            M
          
          
            k
             
             
          
          
              x     
             
          
        
         
        Q
         
        
          
            z
          
          
            k
          
        
        
           
          
              x     
             
          
        
        
           
          
              x     
             
          
        
      
    
      displaystyle  mathbf  P    k   k    mathbf  M    k         Q  mathbf  z    k              
  

is used instead  Such an approach proves particularly useful when the dimensionality of the observations is much greater than that of the latent states             and can be used build filters that are particularly robust to nonstationarities in the observation model             

Adaptive Kalman filter edit 
Adaptive Kalman filters allow to adapt for process dynamics which are not modeled in the process model 
  
    
      
        
          F
        
         
        t
         
      
    
      displaystyle  mathbf  F   t  
  
  which happens for example in the context of a maneuvering target when a constant velocity  reduced order  Kalman filter is employed for tracking             

Kalman Bucy filter edit 
Kalman Bucy filtering  named for Richard Snowden Bucy  is a continuous time version of Kalman filtering                         
It is based on the state space model


  
    
      
        
          
            
              
                
                  
                    d
                    
                      d
                      t
                    
                  
                
                
                  x
                
                 
                t
                 
              
              
                
                 
                
                  F
                
                 
                t
                 
                
                  x
                
                 
                t
                 
                 
                
                  B
                
                 
                t
                 
                
                  u
                
                 
                t
                 
                 
                
                  w
                
                 
                t
                 
              
            
            
              
                
                  z
                
                 
                t
                 
              
              
                
                 
                
                  H
                
                 
                t
                 
                
                  x
                
                 
                t
                 
                 
                
                  v
                
                 
                t
                 
              
            
          
        
      
    
      displaystyle   begin aligned   frac  d  dt   mathbf  x   t  amp   mathbf  F   t  mathbf  x   t   mathbf  B   t  mathbf  u   t   mathbf  w   t    mathbf  z   t  amp   mathbf  H   t  mathbf  x   t   mathbf  v   t  end aligned   
  

where 
  
    
      
        
          Q
        
         
        t
         
      
    
      displaystyle  mathbf  Q   t  
  
 and 
  
    
      
        
          R
        
         
        t
         
      
    
      displaystyle  mathbf  R   t  
  
 represent the intensities of the two white noise terms 
  
    
      
        
          w
        
         
        t
         
      
    
      displaystyle  mathbf  w   t  
  
 and 
  
    
      
        
          v
        
         
        t
         
      
    
      displaystyle  mathbf  v   t  
  
  respectively 
The filter consists of two differential equations  one for the state estimate and one for the covariance 


  
    
      
        
          
            
              
                
                  
                    d
                    
                      d
                      t
                    
                  
                
                
                  
                    
                      
                        x
                      
                        x e 
                    
                  
                
                 
                t
                 
              
              
                
                 
                
                  F
                
                 
                t
                 
                
                  
                    
                      
                        x
                      
                        x e 
                    
                  
                
                 
                t
                 
                 
                
                  B
                
                 
                t
                 
                
                  u
                
                 
                t
                 
                 
                
                  K
                
                 
                t
                 
                
                   
                  
                    
                      z
                    
                     
                    t
                     
                      x     
                    
                      H
                    
                     
                    t
                     
                    
                      
                        
                          
                            x
                          
                            x e 
                        
                      
                    
                     
                    t
                     
                  
                   
                
              
            
            
              
                
                  
                    d
                    
                      d
                      t
                    
                  
                
                
                  P
                
                 
                t
                 
              
              
                
                 
                
                  F
                
                 
                t
                 
                
                  P
                
                 
                t
                 
                 
                
                  P
                
                 
                t
                 
                
                  
                    F
                  
                  
                    
                      T
                    
                  
                
                 
                t
                 
                 
                
                  Q
                
                 
                t
                 
                  x     
                
                  K
                
                 
                t
                 
                
                  R
                
                 
                t
                 
                
                  
                    K
                  
                  
                    
                      T
                    
                  
                
                 
                t
                 
              
            
          
        
      
    
      displaystyle   begin aligned   frac  d  dt    hat   mathbf  x     t  amp   mathbf  F   t   hat   mathbf  x     t   mathbf  B   t  mathbf  u   t   mathbf  K   t  left  mathbf  z   t   mathbf  H   t   hat   mathbf  x     t  right     frac  d  dt   mathbf  P   t  amp   mathbf  F   t  mathbf  P   t   mathbf  P   t  mathbf  F     textsf  T   t   mathbf  Q   t   mathbf  K   t  mathbf  R   t  mathbf  K     textsf  T   t  end aligned   
  

where the Kalman gain is given by


  
    
      
        
          K
        
         
        t
         
         
        
          P
        
         
        t
         
        
          
            H
          
          
            
              T
            
          
        
         
        t
         
        
          
            R
          
          
              x     
             
          
        
         
        t
         
      
    
      displaystyle  mathbf  K   t   mathbf  P   t  mathbf  H     textsf  T   t  mathbf  R        t  
  

Note that in this expression for 
  
    
      
        
          K
        
         
        t
         
      
    
      displaystyle  mathbf  K   t  
  
 the covariance of the observation noise 
  
    
      
        
          R
        
         
        t
         
      
    
      displaystyle  mathbf  R   t  
  
 represents at the same time the covariance of the prediction error  or innovation  
  
    
      
        
          
            
              
                y
              
                x e 
            
          
        
         
        t
         
         
        
          z
        
         
        t
         
          x     
        
          H
        
         
        t
         
        
          
            
              
                x
              
                x e 
            
          
        
         
        t
         
      
    
      displaystyle   tilde   mathbf  y     t   mathbf  z   t   mathbf  H   t   hat   mathbf  x     t  
  
  these covariances are equal only in the case of continuous time             
The distinction between the prediction and update steps of discrete time Kalman filtering does not exist in continuous time 
The second differential equation  for the covariance  is an example of a Riccati equation  Nonlinear generalizations to Kalman Bucy filters include continuous time extended Kalman filter 

Hybrid Kalman filter edit 
Most physical systems are represented as continuous time models while discrete time measurements are made frequently for state estimation via a digital processor  Therefore  the system model and measurement model are given by


  
    
      
        
          
            
              
                
                  
                    
                      
                        x
                      
                        x d  
                    
                  
                
                 
                t
                 
              
              
                
                 
                
                  F
                
                 
                t
                 
                
                  x
                
                 
                t
                 
                 
                
                  B
                
                 
                t
                 
                
                  u
                
                 
                t
                 
                 
                
                  w
                
                 
                t
                 
                 
              
              
                
                  w
                
                 
                t
                 
              
              
                
                  x   c 
                N
                
                   
                  
                    
                       
                    
                     
                    
                      Q
                    
                     
                    t
                     
                  
                   
                
              
            
            
              
                
                  
                    z
                  
                  
                    k
                  
                
              
              
                
                 
                
                  
                    H
                  
                  
                    k
                  
                
                
                  
                    x
                  
                  
                    k
                  
                
                 
                
                  
                    v
                  
                  
                    k
                  
                
                 
              
              
                
                  
                    v
                  
                  
                    k
                  
                
              
              
                
                  x   c 
                N
                 
                
                   
                
                 
                
                  
                    R
                  
                  
                    k
                  
                
                 
              
            
          
        
      
    
      displaystyle   begin aligned   dot   mathbf  x     t  amp   mathbf  F   t  mathbf  x   t   mathbf  B   t  mathbf  u   t   mathbf  w   t   amp  mathbf  w   t  amp  sim N left  mathbf       mathbf  Q   t  right    mathbf  z    k  amp   mathbf  H    k  mathbf  x    k   mathbf  v    k   amp  mathbf  v    k  amp  sim N  mathbf       mathbf  R    k   end aligned   
  

where


  
    
      
        
          
            x
          
          
            k
          
        
         
        
          x
        
         
        
          t
          
            k
          
        
         
      
    
      displaystyle  mathbf  x    k   mathbf  x   t  k   
  
 
Initialize edit 

  
    
      
        
          
            
              
                
                  x
                
                  x e 
              
            
          
          
             
              x     
             
          
        
         
        E
        
           
          
            
              x
            
             
            
              t
              
                 
              
            
             
          
           
        
         
        
          
            P
          
          
             
              x     
             
          
        
         
        Var
          x     
        
           
          
            
              x
            
            
               
              
                t
                
                   
                
              
               
            
          
           
        
      
    
      displaystyle   hat   mathbf  x        mid    E left  mathbf  x   t      right   mathbf  P      mid     operatorname  Var   left  mathbf  x   left t     right  right  
  

Predict edit 

  
    
      
        
          
            
              
                
                  
                    
                      
                        
                          
                            x
                          
                            x e 
                        
                      
                        x d  
                    
                  
                
                 
                t
                 
              
              
                
                 
                
                  F
                
                 
                t
                 
                
                  
                    
                      
                        x
                      
                        x e 
                    
                  
                
                 
                t
                 
                 
                
                  B
                
                 
                t
                 
                
                  u
                
                 
                t
                 
                
                    with  xa  
                
                
                  
                    
                      
                        x
                      
                        x e 
                    
                  
                
                
                   
                  
                    t
                    
                      k
                        x     
                       
                    
                  
                   
                
                 
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                     
                      x     
                    k
                      x     
                     
                  
                
              
            
            
              
                  x  d  
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
              
              
                
                 
                
                  
                    
                      
                        x
                      
                        x e 
                    
                  
                
                
                   
                  
                    t
                    
                      k
                    
                  
                   
                
              
            
            
              
                
                  
                    
                      
                        P
                      
                        x d  
                    
                  
                
                 
                t
                 
              
              
                
                 
                
                  F
                
                 
                t
                 
                
                  P
                
                 
                t
                 
                 
                
                  P
                
                 
                t
                 
                
                  F
                
                 
                t
                
                   
                  
                    
                      T
                    
                  
                
                 
                
                  Q
                
                 
                t
                 
                
                    with  xa  
                
                
                  P
                
                
                   
                  
                    t
                    
                      k
                        x     
                       
                    
                  
                   
                
                 
                
                  
                    P
                  
                  
                    k
                      x     
                     
                      x     
                    k
                      x     
                     
                  
                
              
            
            
              
                  x  d  
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
              
              
                
                 
                
                  P
                
                
                   
                  
                    t
                    
                      k
                    
                  
                   
                
              
            
          
        
      
    
      displaystyle   begin aligned   dot   hat   mathbf  x      t  amp   mathbf  F   t   hat   mathbf  x     t   mathbf  B   t  mathbf  u   t   text   with     hat   mathbf  x     left t  k    right    hat   mathbf  x      k   mid k      Rightarrow   hat   mathbf  x      k mid k    amp    hat   mathbf  x     left t  k  right     dot   mathbf  P     t  amp   mathbf  F   t  mathbf  P   t   mathbf  P   t  mathbf  F   t    textsf  T    mathbf  Q   t   text   with    mathbf  P   left t  k    right   mathbf  P    k   mid k      Rightarrow  mathbf  P    k mid k    amp   mathbf  P   left t  k  right  end aligned   
  

The prediction equations are derived from those of continuous time Kalman filter without update from measurements  i e   
  
    
      
        
          K
        
         
        t
         
         
         
      
    
      displaystyle  mathbf  K   t    
  
  The predicted state and covariance are calculated respectively by solving a set of differential equations with the initial value equal to the estimate at the previous step 
For the case of linear time invariant systems  the continuous time dynamics can be exactly discretized into a discrete time system using matrix exponentials 

Update edit 

  
    
      
        
          
            
              
                
                  
                    K
                  
                  
                    k
                  
                
              
              
                
                 
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
                
                  
                    H
                  
                  
                    k
                  
                  
                    
                      T
                    
                  
                
                
                  
                     
                    
                      
                        
                          H
                        
                        
                          k
                        
                      
                      
                        
                          P
                        
                        
                          k
                            x     
                          k
                            x     
                           
                        
                      
                      
                        
                          H
                        
                        
                          k
                        
                        
                          
                            T
                          
                        
                      
                       
                      
                        
                          R
                        
                        
                          k
                        
                      
                    
                     
                  
                  
                      x     
                     
                  
                
              
            
            
              
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                    k
                  
                
              
              
                
                 
                
                  
                    
                      
                        
                          x
                        
                          x e 
                      
                    
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
                 
                
                  
                    K
                  
                  
                    k
                  
                
                
                   
                  
                    
                      
                        z
                      
                      
                        k
                      
                    
                      x     
                    
                      
                        H
                      
                      
                        k
                      
                    
                    
                      
                        
                          
                            
                              x
                            
                              x e 
                          
                        
                      
                      
                        k
                          x     
                        k
                          x     
                         
                      
                    
                  
                   
                
              
            
            
              
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                  
                
              
              
                
                 
                
                   
                  
                    
                      I
                    
                      x     
                    
                      
                        K
                      
                      
                        k
                      
                    
                    
                      
                        H
                      
                      
                        k
                      
                    
                  
                   
                
                
                  
                    P
                  
                  
                    k
                      x     
                    k
                      x     
                     
                  
                
              
            
          
        
      
    
      displaystyle   begin aligned  mathbf  K    k  amp   mathbf  P    k mid k    mathbf  H    k    textsf  T   left  mathbf  H    k  mathbf  P    k mid k    mathbf  H    k    textsf  T    mathbf  R    k  right          hat   mathbf  x      k mid k  amp    hat   mathbf  x      k mid k     mathbf  K    k  left  mathbf  z    k   mathbf  H    k   hat   mathbf  x      k mid k    right    mathbf  P    k mid k  amp   left  mathbf  I    mathbf  K    k  mathbf  H    k  right  mathbf  P    k mid k    end aligned   
  

The update equations are identical to those of the discrete time Kalman filter 

Variants for the recovery of sparse signals edit 
The traditional Kalman filter has also been employed for the recovery of sparse  possibly dynamic  signals from noisy observations  Recent works                                     utilize notions from the theory of compressed sensing sampling  such as the restricted isometry property and related probabilistic recovery arguments  for sequentially estimating the sparse state in intrinsically low dimensional systems 

Relation to Gaussian processes edit 
Since linear Gaussian state space models lead to Gaussian processes  Kalman filters can be viewed as sequential solvers for Gaussian process regression             

Applications edit 

Attitude and heading reference systems
Autopilot
Electric battery state of charge  SoC  estimation                        
Brain computer interfaces                                    
Tracking and vertex fitting of charged particles in particle detectors            
Tracking of objects in computer vision
Dynamic positioning in shipping
Economics  in particular macroeconomics  time series analysis  and econometrics            
Inertial guidance system
Nuclear medicine   single photon emission computed tomography image restoration            
Orbit determination
Power system state estimation
Radar tracker
Satellite navigation systems
Seismology            
Sensorless control of AC motor variable frequency drives
Simultaneous localization and mapping
Speech enhancement
Visual odometry
Weather forecasting
Navigation system
 D modeling
Structural health monitoring
Human sensorimotor processing            

See also edit 

Alpha beta filter
Inverse variance weighting
Covariance intersection
Data assimilation
Ensemble Kalman filter
Extended Kalman filter
Fast Kalman filter
Filtering problem  stochastic processes 
Generalized filtering
Invariant extended Kalman filter
Kernel adaptive filter
Masreliez s theorem
Moving horizon estimation
Particle filter estimator
PID controller
Predictor corrector method
Recursive least squares filter
Schmidt Kalman filter
Separation principle
Sliding mode control
State transition matrix
Stochastic differential equations
Switching Kalman filter

References edit 


  Lacey  Tony   Chapter    Tutorial  The Kalman Filter   PDF  

  Fauzi  Hilman  Batool  Uzma     July         A Three bar Truss Design using Single solution Simulated Kalman Filter Optimizer   Mekatronika                 doi          mekatronika v i        S CID                

  Paul Zarchan  Howard Musoff         Fundamentals of Kalman Filtering  A Practical Approach  American Institute of Aeronautics and Astronautics  Incorporated  ISBN                        

  Lora Millan  Julio S   Hidalgo  Andres F   Rocon  Eduardo          An IMUs Based Extended Kalman Filter to Estimate Gait Lower Limb Sagittal Kinematics for the Control of Wearable Robotic Devices   IEEE Access                    Bibcode     IEEEA    n    L  doi         ACCESS               hdl               ISSN                 S CID                

  Kalita  Diana  Lyakhov  Pavel  December         Moving Object Detection Based on a Combination of Kalman Filter and Median Filtering   Big Data and Cognitive Computing              doi         bdcc         ISSN                

  Ghysels  Eric  Marcellino  Massimiliano         Applied Economic Forecasting using Time Series Methods  New York  NY  Oxford University Press  p            ISBN                         OCLC                 

  Azzam  M  Abdullah  Batool  Uzma  Fauzi  Hilman     July         Design of an Helical Spring using Single solution Simulated Kalman Filter Optimizer   Mekatronika                doi          mekatronika v i        S CID                

  Wolpert  Daniel  Ghahramani  Zoubin          Computational principles of movement neuroscience   Nature Neuroscience             doi                PMID                S CID             

  Kalman  R  E           A New Approach to Linear Filtering and Prediction Problems   Journal of Basic Engineering             doi                    S CID              

  Humpherys  Jeffrey          A Fresh Look at the Kalman Filter   SIAM Review                   doi                   

  Uhlmann  Jeffrey  Julier  Simon          Gaussianity and the Kalman Filter  A Simple Yet Complicated Relationship   PDF   Journal de Ciencia e Ingenier a                 doi          JCI           S CID                 See Uhlmann and Julier for roughly a dozen instances of this misconception in the literature 

  Li  Wangyan  Wang  Zidong  Wei  Guoliang  Ma  Lifeng  Hu  Jun  Ding  Derui          A Survey on Multisensor Fusion and Consensus Filtering for Sensor Networks   Discrete Dynamics in Nature and Society              doi                      ISSN                

  Li  Wangyan  Wang  Zidong  Ho  Daniel W  C   Wei  Guoliang          On Boundedness of Error Covariances for Kalman Consensus Filtering Problems   IEEE Transactions on Automatic Control                     doi         TAC               ISSN                 S CID                

  Lauritzen  S       L   December         Time series analysis in       A discussion of contributions made by T N       Thiele   International Statistical Review                   doi                  JSTOR               He derives a recursive procedure for estimating the regression component and predicting the Brownian motion  The procedure is now known as Kalman filtering 

  Lauritzen  S       L          Thiele  Pioneer in Statistics  New York  Oxford University Press  p           ISBN                         He solves the problem of estimating the regression coefficients and predicting the values of the Brownian motion by the method of least squares and gives an elegant recursive procedure for carrying out the calculations  The procedure is nowadays known as Kalman filtering 

  Grewal  Mohinder S   Andrews  Angus P               Kalman filtering  theory and practice using MATLAB   th      ed    Hoboken  New Jersey  Wiley  pp              ISBN                        

   Mohinder S  Grewal and Angus P  Andrews   PDF   Archived from the original  PDF  on             Retrieved            

  Jerrold H  Suddath  Robert H  Kidd  Arnold G  Reinhold  August        A Linearized Error Analysis Of Onboard Primary Navigation Systems For The Apollo Lunar Module  NASA TN D       PDF   NASA Technical Note   National Aeronautics and Space Administration 

  Stratonovich  R  L          Optimum nonlinear systems which bring about a separation of a signal with constant parameters from noise  Radiofizika       pp               

  Stratonovich  R  L          On the theory of optimal non linear filtering of random functions  Theory of Probability and Its Applications     pp               

  Stratonovich  R  L         Application of the Markov processes theory to optimal filtering  Radio Engineering and Electronic Physics        pp            

  Stratonovich  R  L          Conditional Markov Processes  Theory of Probability and Its Applications     pp               

  Stepanov  O  A      May         Kalman filtering  Past and present  An outlook from Russia   On the occasion of the   th birthday of Rudolf Emil Kalman    Gyroscopy and Navigation              Bibcode     GyNav         S  doi         S                  S CID               

  Gaylor  David  Lightsey  E  Glenn          GPS INS Kalman Filter Design for Spacecraft Operating in the Proximity of International Space Station   AIAA Guidance  Navigation  and Control Conference and Exhibit  doi                      ISBN                        

  Ingvar Strid  Karl Walentin  April         Block Kalman Filtering for Large Scale DSGE Models   Computational Economics                   CiteSeerX                       doi         s                  hdl              S CID              

  Martin M ller Andreasen          Non linear DSGE Models  The Central Difference Kalman Filter  and The Mean Shifted Particle Filter  

  a b Roweis  S  Ghahramani  Z          A unifying review of linear gaussian models   PDF   Neural Computation                  doi                             PMID               S CID              

  Hamilton  J          Time Series Analysis  Princeton University Press  Chapter      The Kalman Filter 

  Ishihara  J Y   Terra  M H   Campos  J C T           Robust Kalman Filter for Descriptor Systems   IEEE Transactions on Automatic Control                doi         TAC              S CID               

  Terra  Marco H   Cerri  Joao P   Ishihara  Joao Y           Optimal Robust Linear Quadratic Regulator for Systems Subject to Uncertainties   IEEE Transactions on Automatic Control                     doi         TAC               S CID              

  Kelly  Alonzo          A  D state space formulation of a navigation Kalman filter for autonomous vehicles   PDF   DTIC Document      Archived  PDF  from the original on December                Corrected Version Archived            at the Wayback Machine

  Reid  Ian  Term  Hilary   Estimation II   PDF   www robots ox ac uk  Oxford University  Retrieved   August      

  Rajamani  Murali  October        Data based Techniques to Improve State Estimation in Model Predictive Control  PDF   PhD Thesis   University of Wisconsin Madison  Archived from the original  PDF  on             Retrieved            

  Rajamani  Murali R   Rawlings  James B           Estimation of the disturbance structure from data using semidefinite programming and optimal weighting   Automatica                   doi         j automatica              S CID              

   Autocovariance Least Squares Toolbox   Jbrwww che wisc edu  Retrieved            

  Bania  P   Baranowski  J      December        Field Kalman Filter and its approximation  IEEE   th Conference on Decision and Control  CDC   Las Vegas  NV  USA  IEEE  pp                 

  a b Greenberg  Ido  Yannay  Netanel  Mannor  Shie                Optimization or Architecture  How to Hack Kalman Filtering   Advances in Neural Information Processing Systems                   arXiv            

  Bar Shalom  Yaakov  Li  X  Rong  Kirubarajan  Thiagalingam         Estimation with Applications to Tracking and Navigation  New York  USA  John Wiley  amp  Sons  Inc  pp           ff  doi                     ISBN                  X 

  Three optimality tests with numerical examples are described in  Peter  Matisko          Optimality Tests and Adaptive Kalman Filter     th IFAC Symposium on System Identification  IFAC Proceedings Volumes  Vol           pp                  doi                    BE             ISBN                        

  Spall  James C           The Kantorovich inequality for error analysis of the Kalman filter with unknown noise distributions   Automatica                      doi                              

  Maryak  J L   Spall  J C   Heydon  B D           Use of the Kalman Filter for Inference in State Space Models with Unknown Noise Distributions   IEEE Transactions on Automatic Control             doi         TAC              S CID               

  a b Walrand  Jean  Dimakis  Antonis  August        Random processes in Systems    Lecture Notes  PDF   pp              Archived from the original  PDF  on             Retrieved            

  Sant  Donald T   Generalized least squares applied to time varying parameter models   Annals of Economic and Social Measurement  Volume    number    NBER                 Online Pdf

  Anderson  Brian D  O   Moore  John B          Optimal Filtering  New York  Prentice Hall  pp                ISBN                        

  Jingyang Lu    False information injection attack on dynamic state estimation in multi sensor systems   Fusion     

  a b Thornton  Catherine L      October        Triangular Covariance Factorizations for Kalman Filtering  PhD   NASA  NASA Technical Memorandum        

  a b c Bierman  G J           Factorization Methods for Discrete Sequential Estimation   Factorization Methods for Discrete Sequential Estimation  Bibcode     fmds book     B 

  a b Bar Shalom  Yaakov  Li  X  Rong  Kirubarajan  Thiagalingam  July        Estimation with Applications to Tracking and Navigation  New York  John Wiley  amp  Sons  pp                ISBN                        

  Golub  Gene H   Van Loan  Charles F          Matrix Computations  Johns Hopkins Studies in the Mathematical Sciences  Third      ed    Baltimore  Maryland  Johns Hopkins University  p            ISBN                        

  Higham  Nicholas J          Accuracy and Stability of Numerical Algorithms  Second      ed    Philadelphia  PA  Society for Industrial and Applied Mathematics  p            ISBN                        

  S rkk   S    ngel F  Garc a Fern ndez          Temporal Parallelization of Bayesian Smoothers   IEEE Transactions on Automatic Control                   arXiv             doi         TAC               S CID                

   Parallel Prefix Sum  Scan  with CUDA   developer nvidia com   Retrieved             The scan operation is a simple and powerful parallel primitive with a broad range of applications  In this chapter we have explained an efficient implementation of scan using CUDA  which achieves a significant speedup compared to a sequential implementation on a fast CPU  and compared to a parallel implementation in OpenGL on the same GPU  Due to the increasing power of commodity parallel processors such as GPUs  we expect to see data parallel algorithms such as scan to increase in importance over the coming years 

  Masreliez  C  Johan  Martin  R D          Robust Bayesian estimation for the linear model and robustifying the Kalman filter   IEEE Transactions on Automatic Control                   doi         TAC              

  L tkepohl  Helmut         Introduction to Multiple Time Series Analysis  Heidelberg  Springer Verlag Berlin  p           

  Gustafsson  Fredrik         Statistical sensor fusion  Third      ed    Lund  Studentlitteratur  pp                ISBN                        

  a b Gabriel T  Terejanu                Discrete Kalman Filter Tutorial   PDF   Archived from the original  PDF  on             Retrieved            

  Anderson  Brian D  O   Moore  John B          Optimal Filtering  Englewood Cliffs  NJ  Prentice Hall  Inc  pp                ISBN                        

  Rauch  H E   Tung  F   Striebel  C  T   August         Maximum likelihood estimates of linear dynamic systems   AIAA Journal                    Bibcode     AIAAJ         R  doi                

  Gibbs  Richard G   February         Square Root Modified Bryson Frazier Smoother   IEEE Transactions on Automatic Control                   doi         TAC              

  Gibbs  Richard G           New Kalman filter and smoother consistency tests   Automatica                      doi         j automatica             

  Einicke  G A   March         Optimal and Robust Noncausal Filter Formulations   IEEE Transactions on Signal Processing                     Bibcode     ITSP          E  doi         TSP              S CID               

  Einicke  G A   April         Asymptotic Optimality of the Minimum Variance Fixed Interval Smoother   IEEE Transactions on Signal Processing                     Bibcode     ITSP          E  doi         TSP              S CID               

  Einicke  G A   Ralston  J C   Hargrave  C O   Reid  D C   Hainsworth  D W   December         Longwall Mining Automation  An Application of Minimum Variance Smoothing   IEEE Control Systems Magazine                 doi         MCS              S CID               

  Einicke  G A   December         Asymptotic Optimality of the Minimum Variance Fixed Interval Smoother   IEEE Transactions on Automatic Control                      Bibcode     ITSP          E  doi         TSP              S CID               

  Einicke  G A   December         Iterative Frequency Weighted Filtering and Smoothing Procedures   IEEE Signal Processing Letters                      Bibcode     ISPL          E  doi         LSP               S CID               

  Biswas  Sanat K   Qiao  Li  Dempster  Andrew G                 A quantified approach of predicting suitability of using the Unscented Kalman Filter in a non linear application   Automatica               doi         j automatica              ISSN                 S CID                

  a b Julier  Simon J   Uhlmann  Jeffrey K           Unscented filtering and nonlinear estimation   Proceedings of the IEEE                   doi         JPROC              S CID              

  Julier  Simon J   Uhlmann  Jeffrey K           New extension of the Kalman filter to nonlinear systems   PDF   In Kadar  Ivan  ed    Signal Processing  Sensor Fusion  and Target Recognition VI  Proceedings of SPIE  Vol          pp                Bibcode     SPIE          J  CiteSeerX                     doi                    S CID               Retrieved            

  Menegaz  H  M  T   Ishihara  J  Y   Borges  G  A   Vargas  A  N   October         A Systematization of the Unscented Kalman Filter Theory   IEEE Transactions on Automatic Control                      doi         tac               hdl                   ISSN                 S CID               

  Gustafsson  Fredrik  Hendeby  Gustaf          Some Relations Between Extended and Unscented Kalman Filters   IEEE Transactions on Signal Processing                   Bibcode     ITSP          G  doi         tsp               S CID               

  Van der Merwe  R   Wan  E A           The square root unscented Kalman filter for state and parameter estimation        IEEE International Conference on Acoustics  Speech  and Signal Processing  Proceedings  Cat  No   CH        Vol          pp                  doi         ICASSP              ISBN                     S CID              

  Wan  E A   Van Der Merwe  R           The unscented Kalman filter for nonlinear estimation   PDF   Proceedings of the IEEE      Adaptive Systems for Signal Processing  Communications  and Control Symposium  Cat  No   EX      p            CiteSeerX                       doi         ASSPCC              ISBN                         S CID                Archived from the original  PDF  on             Retrieved            

  Sarkka  Simo  September         On Unscented Kalman Filtering for State Estimation of Continuous Time Nonlinear Systems   IEEE Transactions on Automatic Control                     doi         TAC             

  a b Burkhart  Michael C   Brandman  David M   Franco  Brian  Hochberg  Leigh  Harrison  Matthew T           The Discriminative Kalman Filter for Bayesian Filtering with Nonlinear and Nongaussian Observation Models   Neural Computation                    doi         neco a        PMC               PMID                S CID                 Retrieved    March      

  a b Burkhart  Michael C          A Discriminative Approach to Bayesian Filtering with Applications to Human Neural Decoding  Thesis   Providence  RI  USA  Brown University  doi          nhfp xv   

  a b Brandman  David M   Burkhart  Michael C   Kelemen  Jessica  Franco  Brian  Harrison  Matthew T   Hochberg  Leigh R           Robust Closed Loop Control of a Cursor in a Person with Tetraplegia using Gaussian Process Regression   Neural Computation                      doi         neco a        PMC               PMID                Retrieved    March      

  Bar Shalom  Yaakov  Li  X  Rong  Kirubarajan  Thiagalingam         Estimation with Applications to Tracking and Navigation  New York  USA  John Wiley  amp  Sons  Inc  pp           ff  doi                     ISBN                  X 

  Bucy  R S  and Joseph  P D   Filtering for Stochastic Processes with Applications to Guidance  John Wiley  amp  Sons         nd Edition  AMS Chelsea Publ         ISBN                   

  Jazwinski  Andrew H   Stochastic processes and filtering theory  Academic Press  New York        ISBN                   

  Kailath  T           An innovations approach to least squares estimation  Part I  Linear filtering in additive white noise   IEEE Transactions on Automatic Control                   doi         TAC              

  Vaswani  Namrata          Kalman filtered Compressed Sensing          th IEEE International Conference on Image Processing  pp                arXiv            doi         ICIP               ISBN                         S CID              

  Carmi  Avishy  Gurfil  Pini  Kanevsky  Dimitri          Methods for sparse signal recovery using Kalman filtering with embedded pseudo measurement norms and quasi norms   IEEE Transactions on Signal Processing                     Bibcode     ITSP          C  doi         TSP               S CID               

  Zachariah  Dave  Chatterjee  Saikat  Jansson  Magnus          Dynamic Iterative Pursuit   IEEE Transactions on Signal Processing                     arXiv            Bibcode     ITSP          Z  doi         TSP               S CID               

  S rkk   Simo  Hartikainen  Jouni  Svensson  Lennart  Sandblom  Fredrik                On the relation between Gaussian process quadratures and sigma point methods   arXiv             stat ME  

  Vasebi  Amir  Partovibakhsh  Maral  Bathaee  S  Mohammad Taghi          A novel combined battery model for state of charge estimation in lead acid batteries based on extended Kalman filter for hybrid electric vehicle applications   Journal of Power Sources                  Bibcode     JPS           V  doi         j jpowsour             

  Vasebi  A   Bathaee  S M T   Partovibakhsh  M           Predicting state of charge of lead acid batteries for hybrid electric vehicles by extended Kalman filter   Energy Conversion and Management                 Bibcode     ECM           V  doi         j enconman             

  Fruhwirth  R           Application of Kalman filtering to track and vertex fitting   Nuclear Instruments and Methods in Physics Research Section A                      Bibcode     NIMPA         F  doi                              

  Harvey  Andrew C           Applications of the Kalman filter in econometrics   In Bewley  Truman  ed    Advances in Econometrics  New York  Cambridge University Press  pp          f  ISBN                        

  Boulfelfel  D   Rangayyan  R M   Hahn  L J   Kloiber  R   Kuduvalli  G R           Two dimensional restoration of single photon emission computed tomography images using the Kalman filter   IEEE Transactions on Medical Imaging                   doi                    PMID               

  Bock  Y   Crowell  B   Webb  F   Kedar  S   Clayton  R   Miyahara  B           Fusion of High Rate GPS and Seismic Data  Applications to Early Warning Systems for Mitigation of Geological Hazards   AGU Fall Meeting Abstracts      G  B     Bibcode     AGUFM G  B    B 

  Wolpert  D  M   Miall  R  C           Forward Models for Physiological Motor Control   Neural Networks                    doi         S                      PMID               


Further reading edit 
This  Further reading  section may need cleanup  Please read the editing guide and help improve the section    June        Learn how and when to remove this message 

Einicke  G A          Smoothing  Filtering and Prediction  Estimating the Past  Present and Future   nd ed    Amazon Prime Publishing  ISBN                        
Jinya Su  Baibing Li  Wen Hua Chen          On existence  optimality and asymptotic stability of the Kalman filter with partially observed inputs   Automatica               doi         j automatica             
Gelb  A          Applied Optimal Estimation  MIT Press 
Kalman  R E           A new approach to linear filtering and prediction problems   PDF   Journal of Basic Engineering                 doi                    S CID               Archived from the original  PDF  on             Retrieved            
Kalman  R E   Bucy  R S           New Results in Linear Filtering and Prediction Theory   Journal of Basic Engineering              CiteSeerX                       doi                    S CID              
Harvey  A C          Forecasting  Structural Time Series Models and the Kalman Filter  Cambridge University Press  ISBN                        
Roweis  S   Ghahramani  Z           A Unifying Review of Linear Gaussian Models   PDF   Neural Computation                   doi                             PMID               S CID              
Simon  D          Optimal State Estimation  Kalman  H Infinity  and Nonlinear Approaches  Wiley Interscience  Archived from the original on             Retrieved            
Warwick  K           Optimal observers for ARMA models   International Journal of Control                     doi                           
Bierman  G J          Factorization Methods for Discrete Sequential Estimation  Mathematics in Science and Engineering  Vol            Mineola  N Y   Dover Publications  ISBN                        
Bozic  S M          Digital and Kalman filtering  Butterworth Heinemann 
Haykin  S          Adaptive Filter Theory  Prentice Hall 
Liu  W   Principe  J C  and Haykin  S          Kernel Adaptive Filtering  A Comprehensive Introduction  John Wiley   cite book     CS  maint  multiple names  authors list  link 
Manolakis  D G          Statistical and Adaptive signal processing  Artech House 
Welch  Greg  Bishop  Gary          SCAAT  incremental tracking with incomplete information   PDF   SIGGRAPH     Proceedings of the   th annual conference on Computer graphics and interactive techniques  ACM Press Addison Wesley Publishing Co  pp                doi                        ISBN                         S CID              
Jazwinski  Andrew H          Stochastic Processes and Filtering  Mathematics in Science and Engineering  New York  Academic Press  p            ISBN                        
Maybeck  Peter S           Chapter     PDF   Stochastic Models  Estimation  and Control  Mathematics in Science and Engineering  Vol              New York  Academic Press  ISBN                        
Moriya  N          Primer to Kalman Filtering  A Physicist Perspective  New York  Nova Science Publishers  Inc  ISBN                        
Dunik  J   Simandl M   Straka O           Methods for Estimating State and Measurement Noise Covariance Matrices  Aspects and Comparison     th IFAC Symposium on System Identification        France  pp                doi                    FR             ISBN                          cite book     CS  maint  location missing publisher  link 
Chui  Charles K   Chen  Guanrong         Kalman Filtering with Real Time Applications  Springer Series in Information Sciences  Vol            th      ed    New York  Springer  p            ISBN                        
Spivey  Ben  Hedengren  J  D  and Edgar  T  F           Constrained Nonlinear Estimation for Industrial Process Fouling   Industrial  amp  Engineering Chemistry Research                      doi         ie          cite journal     CS  maint  multiple names  authors list  link 
Thomas Kailath  Ali H  Sayed  Babak Hassibi         Linear Estimation  NJ  Prentice Hall  ISBN                        
Ali H  Sayed         Adaptive Filters  NJ  Wiley  ISBN                        

External links edit 
This article s use of external links may not follow Wikipedia s policies or guidelines  Please improve this article by removing excessive or inappropriate external links  and converting useful links where appropriate into footnote references    June        Learn how and when to remove this message 



Wikimedia Commons has media related to Kalman filters 

A New Approach to Linear Filtering and Prediction Problems  by R  E  Kalman      
Kalman and Bayesian Filters in Python  Open source Kalman filtering textbook 
How a Kalman filter works  in pictures  Illuminates the Kalman filter with pictures and colors
Kalman Bucy Filter  a derivation of the Kalman Bucy Filter
MIT Video Lecture on the Kalman filter on YouTube
Kalman filter in Javascript  Open source Kalman filter library for node js and the web browser 
An Introduction to the Kalman Filter Archived            at the Wayback Machine  SIGGRAPH      Course  Greg Welch and Gary Bishop
Kalman Filter webpage  with many links
Kalman Filter Explained Simply  Step by Step Tutorial of the Kalman Filter with Equations
 Kalman filters used in Weather models   PDF   SIAM News          October       Archived from the original  PDF  on             Retrieved            
Haseltine  Eric L   Rawlings  James B           Critical Evaluation of Extended Kalman Filtering and Moving Horizon Estimation   Industrial  amp  Engineering Chemistry Research                doi         ie      l 
Gerald J  Bierman s Estimation Subroutine Library  Corresponds to the code in the research monograph  Factorization Methods for Discrete Sequential Estimation  originally published by Academic Press in       Republished by Dover 
Matlab Toolbox implementing parts of Gerald J  Bierman s Estimation Subroutine Library     permanent dead link       UD   UDU  and LD   LDL  factorization with associated time and measurement updates making up the Kalman filter 
Matlab Toolbox of Kalman Filtering applied to Simultaneous Localization and Mapping  Vehicle moving in  D   D and  D
The Kalman Filter in Reproducing Kernel Hilbert Spaces A comprehensive introduction 
Matlab code to estimate Cox Ingersoll Ross interest rate model with Kalman Filter Archived            at the Wayback Machine  Corresponds to the paper  estimating and testing exponential affine term structure models by kalman filter  published by Review of Quantitative Finance and Accounting in      
Online demo of the Kalman Filter  Demonstration of Kalman Filter  and other data assimilation methods  using twin experiments 
kalman filter com  Insights into the use of Kalman Filters in different domains 
Botella  Guillermo  Mart n h   Jos  Antonio  Santos  Matilde  Meyer Baese  Uwe          FPGA Based Multimodal Embedded Sensor System Integrating Low  and Mid Level Vision   Sensors                      Bibcode     Senso         B  doi         s           PMC               PMID               
Examples and how to on using Kalman Filters with MATLAB Archived            at the Wayback Machine A Tutorial on Filtering and Estimation
Explaining Filtering  Estimation  in One Hour  Ten Minutes  One Minute  and One Sentence  by Yu Chi Ho
Simo S rkk           Bayesian Filtering and Smoothing   Cambridge University Press  Full text available on author s webpage https   users aalto fi  ssarkka  
vteControl theoryBranches
Adaptive control
Control theory
Digital control
Energy shaping control
Fuzzy control
Hybrid control
Intelligent control
Model predictive control
Multivariable control
Neural control
Nonlinear control
Optimal control
Real time control
Robust control
Stochastic control
System properties
Bode plot
Block diagram
Closed loop transfer function
Controllability
Fourier transform
Frequency response
Laplace transform
Negative feedback
Observability
Performance
Positive feedback
Root locus ethod
Servomechanism
Signal flow graph
State space representation
Stability theory
Steady state analysis  amp  design
System dynamics
Transfer function
Digital control
Discrete time signal
Digital signal processing
Quantization
Real time software
Sampled data
System identification
Z transform
Advanced techniques
Artificial neural network
Coefficient diagram method
Control reconfiguration
Distributed parameter systems
Fractional order control
Fuzzy logic
H infinity loop shaping
Hankel singular value
Kalman filter
Krener s theorem
Least squares
Lyapunov stability
Minor loop feedback
Perceptual control theory
State observer
Vector control
Controllers
Embedded controller
Closed loop controller
Lead lag compensator
Numerical control
PID controller
Programmable logic controller
Control applications
Automation and Remote Control
Distributed control system
Electric motors
Industrial control systems
Mechatronics
Motion control
Process control
Robotics
Supervisory control  SCADA 

vteSatellite navigation systemsOperational
BeiDou
DORIS
Galileo
GLONASS
GPS   NavStar
IRNSS   NAVIC
Historical
BDS   BeiDou  
Transit
Timation
Tsiklon
GNSS augmentation
EGNOS
GAGAN
GPS C  retired 
JPALS
LAAS
MSAS
NTRIP
QZSS   Michibiki
SouthPAN
StarFire
WAAS
SDCM
Related topics
GNSS reflectometry
Kalman filter
Korean Positioning System
United Kingdom Global Navigation Satellite System
Wavelet
RINEX

Authority control databases  National GermanyUnited StatesJapanCzech RepublicIsrael





Retrieved from  https   en wikipedia org w index php title Kalman filter amp oldid